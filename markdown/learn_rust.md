# Rust å­¦ä¹  & ä½¿ç”¨ç¬”è®°

> è¿™æ˜¯ä¸€ä»½ä¸ªäººç¬”è®°ï¼ˆé€ŸæŸ¥ï¼‰ï¼

# Rustï¼Œå¯åŠ¨ï¼

## å•ªå—’ä¸€ä¸‹å°±å®‰è£…å¥½å•¦ï¼

ç›´æ¥ä½¿ç”¨ `rustup` è¿›è¡Œå®‰è£…ã€‚
```bash
curl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh

. "$HOME/.cargo/env"

rustc --version
cargo --version
```

å¦‚æœæ˜¯ Ubuntu ç³»ç»Ÿï¼Œè¿˜éœ€è¦å®‰è£…ï¼ˆå…¶å®ƒæˆ‘ä¸çŸ¥é“ï¼‰ï¼š
```bash
sudo apt update
sudo apt install build-essential
```

æ›´æ–°ï¼š
```bash
rustup update
```

ç¼–è¾‘å™¨ï¼š vscode + rust-analyzer ã€‚

## Hello, Cargo!

åˆ›å»ºé¡¹ç›®ï¼š
```bash
cargo new hello_cargo
cd hello_cargo

# æˆ–è€…å¯¹å½“å‰æ–‡ä»¶å¤¹
cargo init
```

æ„å»ºä¸æ‰§è¡Œï¼š
```bash
# æ„å»º
cargo build

# æ‰§è¡Œ
./target/debug/hello_cargo

# æˆ–è€…ç›´æ¥ run
cargo run
```

ç”¨äºæ£€æŸ¥æ˜¯å¦å¯é€šè¿‡ç¼–è¯‘ï¼ˆå¿«ï¼‰ï¼š
```bash
cargo check
```

**å½“æˆ‘ä»¬è¦æ›´å¿«æ—¶å°±ç”¨ï¼š**

```bash
cargo build --release
```

```bash
cargo run --release
```

> å½“é¡¹ç›®æœ€ç»ˆå‡†å¤‡å¥½å‘å¸ƒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `cargo build --release` æ¥ä¼˜åŒ–ç¼–è¯‘é¡¹ç›®ã€‚è¿™ä¼šåœ¨ `target/release` è€Œä¸æ˜¯ `target/debug` ä¸‹ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™äº›ä¼˜åŒ–å¯ä»¥è®© Rust ä»£ç è¿è¡Œçš„æ›´å¿«ï¼Œä¸è¿‡å¯ç”¨è¿™äº›ä¼˜åŒ–ä¹Ÿéœ€è¦æ¶ˆè€—æ›´é•¿çš„ç¼–è¯‘æ—¶é—´ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ç§ä¸åŒçš„é…ç½®ï¼šä¸€ç§æ˜¯ä¸ºäº†å¼€å‘ï¼Œä½ éœ€è¦å¿«é€Ÿä¸”é¢‘ç¹åœ°é‡æ–°æ„å»ºï¼›å¦ä¸€ç§æ˜¯ä¸ºç”¨æˆ·æ„å»ºæœ€ç»ˆç¨‹åºï¼Œå®ƒä»¬ä¸ä¼šç»å¸¸é‡æ–°æ„å»ºï¼Œå¹¶ä¸”å¸Œæœ›ç¨‹åºè¿è¡Œå¾—è¶Šå¿«è¶Šå¥½ã€‚å¦‚æœä½ åœ¨åŸºå‡†æµ‹è¯•ä»£ç çš„è¿è¡Œæ—¶é—´ï¼Œè¯·ç¡®ä¿è¿è¡Œ `cargo build --release` å¹¶ä½¿ç”¨ `target/release` ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œæµ‹è¯•ã€‚

# è®°å¾—å¸¸å›æ¥çœ‹çœ‹ï¼

## ä»é›¶å¼€å§‹çš„å…¥é—¨ï¼

çŸ¥è¯†æ€»ç»“ï¼š
- **`let`**: å£°æ˜ä¸€ä¸ª**ä¸å¯å˜**çš„å˜é‡ã€‚è¿™æ˜¯é»˜è®¤è¡Œä¸ºï¼Œé¼“åŠ±ç¼–å†™æ›´å®‰å…¨ã€æ›´æ˜“äºæ¨ç†çš„ä»£ç ã€‚
- **`let mut`**: å£°æ˜ä¸€ä¸ª**å¯å˜**çš„å˜é‡ã€‚åªæœ‰ç”¨ `mut` å£°æ˜çš„å˜é‡æ‰èƒ½é‡æ–°èµ‹å€¼æˆ–è¢«ä¿®æ”¹ã€‚
- **æ‰€æœ‰æƒ (Ownership)**: Rust çš„æ ¸å¿ƒç‰¹æ€§ã€‚æ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªè¢«ç§°ä¸ºå…¶â€œæ‰€æœ‰è€…â€çš„å˜é‡ã€‚åœ¨ä»»ä½•æ—¶å€™ï¼Œä¸€ä¸ªå€¼åªèƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚å½“æ‰€æœ‰è€…ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒï¼ˆå†…å­˜è¢«é‡Šæ”¾ï¼‰ã€‚
- **å¼•ç”¨ (References)**: é€šè¿‡ `&` åˆ›å»ºã€‚å®ƒå…è®¸ä½ å¼•ç”¨ï¼ˆä½¿ç”¨ï¼‰ä¸€ä¸ªå€¼è€Œ**ä¸å–å¾—å…¶æ‰€æœ‰æƒ**ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º**å€Ÿç”¨ (borrowing)**ã€‚
    - `&secret_number`: åˆ›å»ºä¸€ä¸ªä¸å¯å˜å¼•ç”¨ã€‚ä½ åªèƒ½è¯»å–å®ƒï¼Œä¸èƒ½ä¿®æ”¹å®ƒã€‚
    - `&mut guess`: åˆ›å»ºä¸€ä¸ªå¯å˜å¼•ç”¨ã€‚ä½ å¯ä»¥è¯»å–å¹¶**ä¿®æ”¹**å®ƒã€‚
- **å…³é”®è§„åˆ™**: åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸå†…ï¼Œå¯¹äºä¸€ä¸ªç‰¹å®šçš„æ•°æ®ï¼Œä½ **åªèƒ½æœ‰ä»¥ä¸‹ä¸¤è€…ä¹‹ä¸€**ï¼š
    - ä¸€ä¸ªæˆ–å¤šä¸ªä¸å¯å˜å¼•ç”¨ (`&T`)ã€‚
    - **å”¯ä¸€**ä¸€ä¸ªå¯å˜å¼•ç”¨ (`&mut T`)ã€‚
    - è¿™ä¸ªè§„åˆ™åœ¨ç¼–è¯‘æ—¶å°±é˜²æ­¢äº†æ•°æ®ç«äº‰ï¼ˆdata racesï¼‰ã€‚
- `String`: å­˜å‚¨åœ¨å †ä¸Šã€å¯å¢é•¿ã€UTF-8 ç¼–ç çš„æ–‡æœ¬ã€‚
- `&str`: å­—ç¬¦ä¸²åˆ‡ç‰‡ (string slice)ï¼Œé€šå¸¸æ˜¯å¯¹ `String` æˆ–å­—ç¬¦ä¸²å­—é¢é‡ (`"hello"`) çš„ä¸€ä¸ªä¸å¯å˜å¼•ç”¨/è§†å›¾ã€‚
- **`loop`**: åˆ›å»ºä¸€ä¸ªæ— é™å¾ªç¯ï¼Œå¿…é¡»ç”¨ `break` æ¥é€€å‡ºã€‚
- **`match`**: æå…¶å¼ºå¤§çš„æ¨¡å¼åŒ¹é…å·¥å…·ã€‚
    - **ç©·å°½æ€§**: å¿…é¡»è¦†ç›–æ‰€æœ‰å¯èƒ½çš„æƒ…å†µï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚
    - **ä½œä¸ºè¡¨è¾¾å¼**: `match` è¯­å¥æœ¬èº«ä¼šè¿”å›ä¸€ä¸ªå€¼ï¼Œå¯ä»¥ç”¨æ¥ç»™å˜é‡èµ‹å€¼ï¼Œå¦‚ `let guess: u32 = match ... { ... };`ã€‚
- Rust æ²¡æœ‰ `try-catch` å¼‚å¸¸ã€‚å¯¹äºå¯èƒ½å¤±è´¥çš„æ“ä½œï¼Œå‡½æ•°ä¼šè¿”å› `Result<T, E>` æšä¸¾ã€‚
    - `Ok(T)`: æ“ä½œæˆåŠŸï¼Œ`T` æ˜¯æˆåŠŸæ—¶è¿”å›çš„å€¼çš„ç±»å‹ã€‚
    - `Err(E)`: æ“ä½œå¤±è´¥ï¼Œ`E` æ˜¯å¤±è´¥æ—¶è¿”å›çš„é”™è¯¯çš„ç±»å‹ã€‚
- ä½ å¯ä»¥ä½¿ç”¨ `let` å£°æ˜ä¸€ä¸ªä¸å¤–éƒ¨ä½œç”¨åŸŸå˜é‡åŒåçš„æ–°å˜é‡ã€‚è¿™ä¸ªæ–°å˜é‡ä¼šâ€œé®è”½â€æ—§å˜é‡ã€‚è¿™å¯¹äºç±»å‹è½¬æ¢éå¸¸æœ‰ç”¨ï¼Œé¿å…äº†ä¸ºè½¬æ¢åçš„å€¼æƒ³ä¸€ä¸ªæ–°åå­—ï¼ˆå¦‚ `guess_str` å’Œ `guess_num`ï¼‰ã€‚

ç¤ºä¾‹ä»£ç ï¼š
```rust
// --- 1. å¼•å…¥ï¼ˆImportingï¼‰ä¸ä½œç”¨åŸŸ ---
// `use` å…³é”®å­—ç”¨äºå°†å¤–éƒ¨æ¨¡å—ï¼ˆåº“ï¼Œä¹Ÿç§°ä¸º crateï¼‰ä¸­çš„é¡¹ï¼ˆitemï¼‰å¼•å…¥åˆ°å½“å‰ä½œç”¨åŸŸã€‚
// è¿™ç±»ä¼¼äº Python çš„ `import` æˆ– C++ çš„ `using namespace`ã€‚

// `std::cmp::Ordering` æ˜¯ä¸€ä¸ªæšä¸¾ï¼ˆenumï¼‰ï¼Œå®ƒæœ‰ä¸‰ä¸ªæˆå‘˜ï¼šLess, Greater, Equalã€‚
// æˆ‘ä»¬åœ¨åé¢çš„æ¯”è¾ƒä¸­ä¼šç”¨åˆ°å®ƒã€‚
use std::cmp::Ordering;

// `std::io` æ˜¯æ ‡å‡†åº“ä¸­å¤„ç†è¾“å…¥/è¾“å‡ºçš„æ¨¡å—ã€‚
use std::io;

// `rand` æ˜¯ä¸€ä¸ªå¤–éƒ¨çš„ crateï¼ˆç¬¬ä¸‰æ–¹åº“ï¼‰ï¼Œä¸æ˜¯ Rust æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ã€‚
// è¦ä½¿ç”¨å®ƒï¼Œå¿…é¡»å…ˆåœ¨é¡¹ç›®çš„ `Cargo.toml` æ–‡ä»¶ä¸­çš„ `[dependencies]` éƒ¨åˆ†æ·»åŠ  `rand = "x.y.z"`ã€‚
// `Rng` æ˜¯ä¸€ä¸ª traitï¼ˆç‰¹å¾ï¼‰ï¼Œå®ƒå®šä¹‰äº†éšæœºæ•°ç”Ÿæˆå™¨åº”å…·å¤‡çš„åŠŸèƒ½ï¼ˆæ¯”å¦‚ `gen_range` æ–¹æ³•ï¼‰ã€‚
// å¿…é¡»å¼•å…¥è¿™ä¸ª traitï¼Œæˆ‘ä»¬æ‰èƒ½ä½¿ç”¨å®ƒæ‰€æä¾›çš„æ–¹æ³•ã€‚
use rand::Rng;

// --- 2. ç¨‹åºå…¥å£ ---
// `fn main()` æ˜¯æ¯ä¸ª Rust å¯æ‰§è¡Œç¨‹åºçš„å…¥å£å‡½æ•°ã€‚ç¨‹åºä»è¿™é‡Œå¼€å§‹è¿è¡Œã€‚
fn main() {
    // `println!` æ˜¯ä¸€ä¸ªå®ï¼ˆmacroï¼‰ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ã€‚
    // åœ¨ Rust ä¸­ï¼Œä»¥ `!` ç»“å°¾çš„è°ƒç”¨é€šå¸¸éƒ½æ˜¯å®ã€‚å®å¯ä»¥å®ç°æ¯”å‡½æ•°æ›´å¼ºå¤§çš„å…ƒç¼–ç¨‹åŠŸèƒ½ã€‚
    println!("Guess the number!");

    // --- 3. å˜é‡ç»‘å®šã€ä¸å¯å˜æ€§ ä¸ ç±»å‹æ¨æ–­ ---
    // `let` å…³é”®å­—ç”¨äºå£°æ˜ä¸€ä¸ªå˜é‡ã€‚åœ¨ Rust ä¸­ï¼Œå˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼ˆimmutableï¼‰ã€‚
    // è¿™æ„å‘³ç€ä¸€æ—¦ `secret_number` è¢«èµ‹å€¼ï¼Œå®ƒçš„å€¼å°±ä¸èƒ½å†è¢«æ”¹å˜ã€‚è¿™æ˜¯ Rust å®‰å…¨æ€§çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ã€‚
    // è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰æ˜¾å¼æŒ‡å®š `secret_number` çš„ç±»å‹ï¼ŒRust ç¼–è¯‘å™¨ä¼šæ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨æ¨æ–­ã€‚
    let secret_number = rand::thread_rng().gen_range(1..=100);
    // `rand::thread_rng()`: è·å–ä¸€ä¸ªä¸å½“å‰çº¿ç¨‹å…³è”çš„ã€æ“ä½œç³»ç»Ÿå·²ç»æ’­ç§çš„éšæœºæ•°ç”Ÿæˆå™¨ã€‚
    // `.gen_range(1..=100)`: è°ƒç”¨ `Rng` trait ä¸­çš„æ–¹æ³•ï¼Œç”Ÿæˆä¸€ä¸ªèŒƒå›´åœ¨ [1, 100] å†…çš„éšæœºæ•°ã€‚
    // `1..=100` æ˜¯ä¸€ä¸ªèŒƒå›´è¡¨è¾¾å¼ï¼Œ`=` è¡¨ç¤ºåŒ…å«ç»“æŸå€¼ 100ã€‚å¦‚æœæ˜¯ `1..100` åˆ™è¡¨ç¤º [1, 100)ã€‚

    // --- 4. å¾ªç¯ ---
    // `loop` å…³é”®å­—ä¼šåˆ›å»ºä¸€ä¸ªæ— é™å¾ªç¯ã€‚æˆ‘ä»¬éœ€è¦åœ¨å¾ªç¯å†…éƒ¨æä¾›ä¸€ä¸ªé€€å‡ºçš„æ¡ä»¶ï¼ˆä¾‹å¦‚ `break`ï¼‰ã€‚
    loop {
        println!("Please input your guess.");

        // --- 5. å¯å˜æ€§ï¼ˆMutabilityï¼‰ä¸ String ç±»å‹ ---
        // æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåœ°æ–¹æ¥å­˜å‚¨ç”¨æˆ·çš„è¾“å…¥ã€‚
        // `let mut guess`ï¼š`mut` å…³é”®å­—ä½¿è¿™ä¸ªå˜é‡å˜ä¸ºå¯å˜çš„ï¼ˆmutableï¼‰ã€‚
        // åªæœ‰å¯å˜å˜é‡çš„å€¼æ‰èƒ½è¢«ä¿®æ”¹ã€‚
        // `String::new()`: åˆ›å»ºä¸€ä¸ªå¯å¢é•¿çš„ã€UTF-8 ç¼–ç çš„å­—ç¬¦ä¸²ã€‚`String` æ˜¯å­˜å‚¨åœ¨å †ä¸Šçš„ã€‚
        // `::` è¯­æ³•ç”¨äºè®¿é—®ç±»å‹çš„å…³è”å‡½æ•°ï¼ˆassociated functionï¼‰ï¼Œç±»ä¼¼äºå…¶ä»–è¯­è¨€çš„é™æ€æ–¹æ³•ã€‚
        let mut guess = String::new();

        // --- 6. I/O æ“ä½œã€å¼•ç”¨ä¸é”™è¯¯å¤„ç† ---
        io::stdin()
            // `.read_line()` æ–¹æ³•ä»æ ‡å‡†è¾“å…¥è¯»å–ä¸€è¡Œæ–‡æœ¬ï¼Œå¹¶å°†å…¶é™„åŠ åˆ°ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸­ã€‚
            // `&mut guess`: è¿™é‡Œæ˜¯å…³é”®ç‚¹ï¼
            // `&` è¡¨ç¤ºæˆ‘ä»¬ä¼ é€’çš„æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼ˆreferenceï¼‰ï¼Œè€Œä¸æ˜¯å€¼çš„æ‰€æœ‰æƒï¼ˆownershipï¼‰ã€‚
            // è¿™æ„å‘³ç€ `read_line` å¯ä»¥â€œå€Ÿç”¨â€`guess` æ¥ä½¿ç”¨ï¼Œè€Œä¸ä¼šæˆä¸ºå®ƒçš„æ–°ä¸»äººã€‚
            // `mut` è¡¨ç¤ºè¿™ä¸ªå¼•ç”¨æ˜¯å¯å˜çš„ï¼Œå³ `read_line` å‡½æ•°å¯ä»¥ä¿®æ”¹ `guess` çš„å†…å®¹ã€‚
            // è¿™æ˜¯ Rust æ‰€æœ‰æƒå’Œå€Ÿç”¨ç³»ç»Ÿçš„æ ¸å¿ƒã€‚
            .read_line(&mut guess)
            // `read_line` è¿”å›ä¸€ä¸ª `Result` ç±»å‹ã€‚`Result` æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œæœ‰ä¸¤ä¸ªå˜ä½“ï¼š`Ok` å’Œ `Err`ã€‚
            // `Ok` è¡¨ç¤ºæ“ä½œæˆåŠŸï¼Œ`Err` è¡¨ç¤ºæ“ä½œå¤±è´¥ã€‚è¿™æ˜¯ Rust å¤„ç†å¯èƒ½å¤±è´¥æ“ä½œçš„ä¸»è¦æ–¹å¼ã€‚
            // `.expect()` æ˜¯ `Result` çš„ä¸€ä¸ªæ–¹æ³•ã€‚å¦‚æœ `Result` æ˜¯ `Ok`ï¼Œå®ƒä¼šè¿”å›å€¼ï¼›
            // å¦‚æœæ˜¯ `Err`ï¼Œç¨‹åºä¼šç«‹å³å´©æºƒï¼ˆpanic!ï¼‰å¹¶æ˜¾ç¤ºä¼ å…¥ `expect` çš„æ¶ˆæ¯ã€‚
            // è¿™åœ¨åŸå‹å¼€å‘æˆ–ç¡®å®šä¸ä¼šå¤±è´¥çš„åœºæ™¯ä¸­å¾ˆæ–¹ä¾¿ï¼Œä½†åœ¨ç”Ÿäº§ä»£ç ä¸­é€šå¸¸ç”¨ `match` æ¥åšæ›´ä¼˜é›…çš„é”™è¯¯å¤„ç†ã€‚
            .expect("Failed to read line");

        // --- 7. é®è”½ï¼ˆShadowingï¼‰ä¸ç±»å‹è½¬æ¢ ---
        // Rust å…è®¸æˆ‘ä»¬ç”¨ `let` å£°æ˜ä¸€ä¸ªä¸ä¹‹å‰å˜é‡åŒåçš„æ–°å˜é‡ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºâ€œé®è”½â€ï¼ˆshadowingï¼‰ã€‚
        // è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ `guess` å˜é‡ï¼Œå®ƒå°†é®è”½ä¹‹å‰çš„ `String` ç±»å‹çš„ `guess`ã€‚
        // è¿™æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„æ¨¡å¼ï¼Œç”¨äºå°†å€¼ä»ä¸€ç§ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ã€‚
        // `: u32` æ˜¯ä¸€ä¸ªç±»å‹æ³¨è§£ï¼Œæˆ‘ä»¬æ˜ç¡®å‘Šè¯‰ Rustï¼Œæ–°çš„ `guess` å˜é‡åº”è¯¥æ˜¯ 32 ä½æ— ç¬¦å·æ•´æ•°ã€‚
        let guess: u32 = match guess.trim().parse() {
            // `match` æ˜¯ Rust ä¸­ä¸€ä¸ªæå…¶å¼ºå¤§çš„æ§åˆ¶æµç»“æ„ï¼Œå®ƒå…è®¸ä½ å°†ä¸€ä¸ªå€¼ä¸ä¸€ç³»åˆ—æ¨¡å¼è¿›è¡Œæ¯”è¾ƒã€‚
            // `guess.trim()`: `String` ç±»å‹çš„ `guess` åœ¨ç”¨æˆ·è¾“å…¥æ—¶ä¼šåŒ…å«æ¢è¡Œç¬¦ï¼ˆä¾‹å¦‚ `5\n`ï¼‰ã€‚
            // `.trim()` ä¼šå»é™¤é¦–å°¾çš„ç©ºç™½å­—ç¬¦ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼ˆ`&str`ï¼‰ã€‚
            // `.parse()`: è¿™æ˜¯ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸Šå¾ˆå¸¸ç”¨çš„æ–¹æ³•ï¼Œå®ƒä¼šå°è¯•å°†å­—ç¬¦ä¸²è§£ææˆæŸç§æ•°å­—ç±»å‹ã€‚
            // Rust ç¼–è¯‘å™¨æ ¹æ® `: u32` çš„ç±»å‹æ³¨è§£ï¼Œæ¨æ–­å‡ºæˆ‘ä»¬æƒ³æŠŠå®ƒè§£ææˆ `u32`ã€‚
            // `.parse()` åŒæ ·è¿”å›ä¸€ä¸ª `Result` ç±»å‹ï¼Œå› ä¸ºè¾“å…¥å¯èƒ½ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„æ•°å­—ï¼ˆæ¯”å¦‚ "hello")ã€‚

            // `Ok(num)`: è¿™æ˜¯ `match` çš„ç¬¬ä¸€ä¸ªåˆ†æ”¯ï¼ˆarmï¼‰ã€‚å¦‚æœ `parse()` æˆåŠŸï¼Œè¿”å› `Ok`ï¼Œ
            // å…¶ä¸­çš„å€¼ä¼šè¢«ç»‘å®šåˆ°å˜é‡ `num` ä¸Šã€‚ç„¶å `=>` å³è¾¹çš„è¡¨è¾¾å¼ `num` çš„å€¼ä¼šæˆä¸ºæ•´ä¸ª `match` è¡¨è¾¾å¼çš„ç»“æœã€‚
            Ok(num) => num,

            // `Err(_)`: è¿™æ˜¯ç¬¬äºŒä¸ªåˆ†æ”¯ã€‚å¦‚æœ `parse()` å¤±è´¥ï¼Œè¿”å› `Err`ã€‚
            // `_` æ˜¯ä¸€ä¸ªé€šé…ç¬¦ï¼Œè¡¨ç¤ºæˆ‘ä»¬ä¸å…³å¿ƒ `Err` é‡Œé¢å…·ä½“æ˜¯ä»€ä¹ˆé”™è¯¯ç±»å‹ã€‚
            // `=> continue`: `continue` å…³é”®å­—ä¼šç«‹å³ç»“æŸæœ¬æ¬¡å¾ªç¯ï¼Œå¹¶è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œæç¤ºç”¨æˆ·å†æ¬¡è¾“å…¥ã€‚
            Err(_) => continue,
        }; // `let` è¯­å¥ä»¥åˆ†å·ç»“å°¾

        println!("You guessed: {guess}"); // æ–°çš„ `{variable}` æ ¼å¼åŒ–è¯­æ³•

        // --- 8. æ¯”è¾ƒä¸ Match è¡¨è¾¾å¼ ---
        // `.cmp()` æ–¹æ³•ä¼šæ¯”è¾ƒä¸¤ä¸ªå€¼ï¼Œå¹¶è¿”å›æˆ‘ä»¬ä¹‹å‰å¼•å…¥çš„ `Ordering` æšä¸¾çš„æŸä¸ªå˜ä½“ã€‚
        // åŒæ ·ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨äº† `&secret_number`ï¼Œä¼ é€’äº†ä¸€ä¸ªä¸å¯å˜å¼•ç”¨ï¼Œåªæ˜¯å€Ÿç”¨å®ƒæ¥æ¯”è¾ƒã€‚
        match guess.cmp(&secret_number) {
            // `match` è¡¨è¾¾å¼å¿…é¡»æ˜¯ç©·å°½çš„ï¼ˆexhaustiveï¼‰ï¼Œå³å¿…é¡»è¦†ç›–æ‰€æœ‰å¯èƒ½çš„æƒ…å†µã€‚
            // `Ordering` åªæœ‰ä¸‰ä¸ªå˜ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬æä¾›äº†ä¸‰ä¸ªåˆ†æ”¯ã€‚
            Ordering::Less => println!("Too small!"),
            Ordering::Greater => println!("Too big!"),
            Ordering::Equal => {
                // å¦‚æœçŒœå¯¹äº†
                println!("You win!");
                // `break` å…³é”®å­—ç”¨äºè·³å‡ºå½“å‰çš„ `loop` å¾ªç¯ã€‚
                break;
            }
        }
    } // loop ç»“æŸ
} // main å‡½æ•°ç»“æŸ
```
## æ˜æ˜åªæ˜¯å¸¸ç”¨å´è¶…å¥½ç”¨ï¼

çŸ¥è¯†æ€»ç»“ï¼š
- **Struct**: å°†å¤šä¸ªç›¸å…³çš„å€¼ç»„åˆæˆä¸€ä¸ªæœ‰æ„ä¹‰çš„ç±»å‹ã€‚æ¯ä¸ªå€¼ç§°ä¸ºä¸€ä¸ªå­—æ®µï¼ˆfieldï¼‰ã€‚é€‚åˆç”¨äºæè¿°â€œä¸€ä¸ªä¸œè¥¿**æ‹¥æœ‰**æŸäº›å±æ€§â€çš„åœºæ™¯ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ª `User` **æœ‰** idã€username å’Œ statusï¼‰ã€‚
- **Enum**: å®šä¹‰ä¸€ä¸ªç±»å‹ï¼Œè¿™ä¸ªç±»å‹çš„å€¼å¯ä»¥æ˜¯å¤šä¸ªä¸åŒå˜ä½“ä¸­çš„**ä¸€ä¸ª**ã€‚é€‚åˆç”¨äºæè¿°â€œä¸€ä¸ªä¸œè¥¿**æ˜¯**æŸç§çŠ¶æ€â€çš„åœºæ™¯ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ª `UserStatus` **æ˜¯** Activeã€Inactive **æˆ–** Bannedï¼‰ã€‚Rust çš„æšä¸¾å˜ä½“å¯ä»¥æºå¸¦å…³è”æ•°æ®ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ã€‚
- ä½¿ç”¨ `impl YourType { ... }` æ¥ä¸ºä½ çš„ `struct` æˆ– `enum` å®šä¹‰æ–¹æ³•ã€‚**æ–¹æ³• (Method)**: ç¬¬ä¸€ä¸ªå‚æ•°é€šå¸¸æ˜¯ `&self`, `&mut self` æˆ– `self`ã€‚é€šè¿‡å®ä¾‹è°ƒç”¨ï¼Œå¦‚ `my_instance.my_method()`ã€‚**å…³è”å‡½æ•° (Associated Function)**: æ²¡æœ‰ `self` å‚æ•°ã€‚é€šè¿‡ç±»å‹åè°ƒç”¨ï¼Œå¦‚ `UserDatabase::new()`ã€‚å¸¸ç”¨ä½œæ„é€ å‡½æ•°ã€‚
- Trait (ç‰¹å¾ï¼šå®šä¹‰å…±äº«è¡Œä¸º) ç±»ä¼¼äºæ¥å£ï¼Œå®ƒå®šä¹‰äº†ä¸€ç»„æ–¹æ³•ç­¾åï¼Œç”¨äºæŠ½è±¡å’Œå…±äº«è¡Œä¸ºã€‚é€šè¿‡ `impl YourTrait for YourType` è¯­æ³•æ¥ä¸ºæŸä¸ªç±»å‹å®ç°ä¸€ä¸ª Traitã€‚è¿™å®ç°äº†å¤šæ€æ€§ï¼šä½ å¯ä»¥ç¼–å†™ä¸€ä¸ªæ¥å—ä»»ä½•å®ç°äº†ç‰¹å®š Trait çš„ç±»å‹çš„å‡½æ•°ã€‚
- `Option<T>` (å¤„ç†â€œå¯èƒ½ä¸å­˜åœ¨â€çš„å€¼) æ˜¯ Rust é¿å… `null` å¼•å‘é”™è¯¯çš„åŸºçŸ³ã€‚å®ƒæ˜¯ä¸€ä¸ªæšä¸¾ï¼Œæœ‰ä¸¤ä¸ªå˜ä½“ï¼š `Some(T)` è¡¨ç¤ºå­˜åœ¨ä¸€ä¸ª `T` ç±»å‹çš„å€¼ã€‚ `None` è¡¨ç¤ºå€¼ä¸å­˜åœ¨ã€‚ç¼–è¯‘å™¨ä¼šå¼ºåˆ¶ä½ å¤„ç† `None` çš„æƒ…å†µï¼Œä»è€Œè®©ä»£ç æ›´å¥å£®ã€‚**`if let Some(x) = my_option`** æ˜¯å¤„ç† `Option` çš„æƒ¯ç”¨æ¨¡å¼ï¼Œæ¯” `match` æ›´ç®€æ´ã€‚
- **Lifetimes (ç”Ÿå‘½å‘¨æœŸ)** æ˜¯ç¼–è¯‘å™¨ç”¨æ¥ç¡®ä¿æ‰€æœ‰**å¼•ç”¨**éƒ½ç»å¯¹æœ‰æ•ˆçš„ç³»ç»Ÿã€‚å®ƒé˜²æ­¢äº†â€œæ‚¬å‚å¼•ç”¨â€ï¼ˆdangling referencesï¼‰ï¼Œå³å¼•ç”¨æŒ‡å‘çš„å†…å­˜å·²ç»è¢«é‡Šæ”¾ã€‚ `fn my_func<'a>(x: &'a str) -> &'a str` ä¸­çš„ `'a` æ˜¯ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‚æ•°ã€‚å®ƒæ˜¯ä¸€ç§æ³›å‹ï¼Œä½†ä½œç”¨äºå¼•ç”¨æœ‰æ•ˆçš„æ—¶é—´èŒƒå›´ï¼Œè€Œéç±»å‹ã€‚å®ƒåœ¨å‡½æ•°ç­¾åä¸­å»ºç«‹è§„åˆ™ï¼Œæ¯”å¦‚â€œè¿”å›çš„å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸä¸èƒ½è¶…è¿‡ä¼ å…¥çš„å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸâ€ã€‚åœ¨å¾ˆå¤šç®€å•åœºæ™¯ä¸‹ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ¨æ–­ç”Ÿå‘½å‘¨æœŸï¼Œæ— éœ€æ‰‹åŠ¨æ ‡æ³¨ã€‚
- **è¿­ä»£å™¨ (Iterators)**: Rust çš„è¿­ä»£å™¨æ˜¯â€œæ‡’æƒ°çš„â€ï¼Œæ„å‘³ç€åœ¨è¢«æ¶ˆè€—ï¼ˆå¦‚è°ƒç”¨ `.collect()`ï¼‰ä¹‹å‰å®ƒä»¬ä¸ä¼šåšä»»ä½•äº‹ã€‚å®ƒä»¬æä¾›äº†ä¸€ç³»åˆ—é«˜æ•ˆã€é“¾å¼è°ƒç”¨çš„æ–¹æ³•ï¼ˆå¦‚ `.map()`, `.filter()`, `.find()`ï¼‰ã€‚
- **é—­åŒ… (Closures)**: `|arg1, arg2| { ... }` å½¢å¼çš„åŒ¿åå‡½æ•°ã€‚å®ƒä»¬éå¸¸è½»é‡ï¼Œå¯ä»¥æ•è·ï¼ˆâ€œé—­åŒ…â€ï¼‰å…¶æ‰€åœ¨ç¯å¢ƒä¸­çš„å˜é‡ã€‚ä¸è¿­ä»£å™¨ç»„åˆä½¿ç”¨æ—¶å¨åŠ›å·¨å¤§ã€‚
- **`iter().filter(...).collect()`** æ˜¯ Rust ä¸­éå¸¸å¸¸è§ä¸”å¼ºå¤§çš„æ•°æ®å¤„ç†æ¨¡å¼ã€‚
- **ç§»åŠ¨ (Move)**: å½“ä½ å°†ä¸€ä¸ªæ‹¥æœ‰å †ä¸Šæ•°æ®ï¼ˆå¦‚ `String`, `Vec`, `Box`ï¼‰çš„å˜é‡ä¼ é€’ç»™å‡½æ•°æˆ–èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡æ—¶ï¼Œæ‰€æœ‰æƒä¼šâ€œç§»åŠ¨â€ã€‚åŸå˜é‡å°†å¤±æ•ˆï¼Œä»¥é˜²æ­¢â€œäºŒæ¬¡é‡Šæ”¾â€å†…å­˜ã€‚åœ¨ `db.add_user(user1)` ä¸­ï¼Œ`user1` çš„æ‰€æœ‰æƒå°±ç§»åŠ¨åˆ°äº† `db.users` å†…éƒ¨ã€‚
- **å€Ÿç”¨ (Borrow)**: é€šè¿‡å¼•ç”¨ (`&` æˆ– `&mut`)ï¼Œä½ å¯ä»¥ä¸´æ—¶â€œå€Ÿç”¨â€ä¸€ä¸ªå€¼çš„ä½¿ç”¨æƒï¼Œè€Œæ— éœ€è½¬ç§»æ‰€æœ‰æƒã€‚è¿™æ˜¯å‡½æ•°è·å–æ•°æ®è€Œä¸æ¶ˆè€—å®ƒçš„ä¸»è¦æ–¹å¼ã€‚

ç¤ºä¾‹ä»£ç ï¼š
```rust
// --- 1. å®šä¹‰ Trait (ç‰¹å¾) ---
// Trait ç”¨äºå®šä¹‰å…±äº«çš„è¡Œä¸ºï¼Œç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„æ¥å£ï¼ˆInterfaceï¼‰ã€‚
// ä»»ä½•ç±»å‹åªè¦å®ç°äº†è¿™ä¸ª traitï¼Œå°±å¯ä»¥ä¿è¯å®ƒå…·æœ‰ `summary` è¿™ä¸ªæ–¹æ³•ã€‚
// è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç¼–å†™æ›´é€šç”¨çš„ä»£ç ã€‚
trait Summarizable {
    // å®šä¹‰ä¸€ä¸ªæ–¹æ³•ç­¾åï¼Œå®ƒæ¥å—ä¸€ä¸ªå¯¹è‡ªèº«çš„ä¸å¯å˜å¼•ç”¨ `&self`ï¼Œ
    // å¹¶è¿”å›ä¸€ä¸ª `String`ã€‚
    fn summary(&self) -> String;
}

// --- 2. å®šä¹‰ Enum (æšä¸¾) ---
// Enum å…è®¸æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå¯ä»¥æ˜¯å¤šç§å˜ä½“ä¹‹ä¸€çš„ç±»å‹ã€‚
// Rust çš„ Enum éå¸¸å¼ºå¤§ï¼Œå®ƒçš„å˜ä½“å¯ä»¥æœ‰å…³è”æ•°æ®ã€‚
#[derive(Debug, PartialEq)] // `derive` æ˜¯ä¸€ä¸ªå®ï¼Œå¯ä»¥ä¸ºç±»å‹è‡ªåŠ¨å®ç°æŸäº› traitã€‚
                         // `Debug` è®©æˆ‘ä»¬èƒ½ç”¨ `{:?}` æ ¼å¼æ‰“å°è¿™ä¸ªæšä¸¾ï¼Œä¾¿äºè°ƒè¯•ã€‚
                         // `PartialEq` è®©æˆ‘ä»¬èƒ½ç”¨ `==` æ¥æ¯”è¾ƒä¸¤ä¸ªæšä¸¾å®ä¾‹ã€‚
enum UserStatus {
    Active, // ç®€å•å˜ä½“
    Inactive, // ç®€å•å˜ä½“
    Banned(String), // `Banned` å˜ä½“æœ‰å…³è”æ•°æ®ï¼šä¸€æ¡ `String` ç±»å‹çš„å°ç¦ç†ç”±ã€‚
}

// --- 3. å®šä¹‰ Struct (ç»“æ„ä½“) ---
// Struct ç”¨äºåˆ›å»ºè‡ªå®šä¹‰çš„ã€æœ‰æ„ä¹‰çš„æ•°æ®ç±»å‹ã€‚
#[derive(Debug)] // åŒæ ·æ´¾ç”Ÿ Debug traitï¼Œæ–¹ä¾¿æ‰“å°ã€‚
struct User {
    id: u32,
    username: String,
    status: UserStatus,
}

// --- 4. å®ç° Trait (`impl Trait for Type`) ---
// ä¸ºæˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ `User` ç±»å‹å®ç° `Summarizable` traitã€‚
impl Summarizable for User {
    // ç°åœ¨æˆ‘ä»¬å¿…é¡»æä¾› `summary` æ–¹æ³•çš„å…·ä½“å®ç°ã€‚
    fn summary(&self) -> String {
        // `format!` å®ç±»ä¼¼äº `println!`ï¼Œä½†å®ƒè¿”å›ä¸€ä¸ªæ ¼å¼åŒ–å¥½çš„ `String`ï¼Œè€Œä¸æ˜¯æ‰“å°åˆ°æ§åˆ¶å°ã€‚
        // `match` è¡¨è¾¾å¼åœ¨è¿™é‡Œç”¨äºæ ¹æ®ä¸åŒçš„ `UserStatus` ç”Ÿæˆä¸åŒçš„æè¿°ã€‚
        let status_desc = match &self.status {
            UserStatus::Active => "Active",
            UserStatus::Inactive => "Inactive",
            // è¿™é‡Œæˆ‘ä»¬ä» `Banned` å˜ä½“ä¸­è§£æ„å‡ºå…³è”æ•°æ® `reason`ã€‚
            UserStatus::Banned(reason) => reason,
        };
        format!("[{}] {}: {}", self.id, self.username, status_desc)
    }
}

// --- 5. å®šä¹‰æ•°æ®åº“ç»“æ„ä½“ ---
struct UserDatabase {
    // `users` å­—æ®µæ˜¯ä¸€ä¸ª `Vec` (Vector)ï¼Œå®ƒæ˜¯ Rust æ ‡å‡†åº“æä¾›çš„å¯å¢é•¿æ•°ç»„ï¼ˆåŠ¨æ€æ•°ç»„ï¼‰ã€‚
    // `Vec<User>` è¡¨ç¤ºè¿™ä¸ª Vec ä¸­å­˜å‚¨çš„å…ƒç´ ç±»å‹æ˜¯ `User`ã€‚
    users: Vec<User>,
}

// --- 6. å®ç° Struct çš„æ–¹æ³• (`impl Type`) ---
// è¿™ä¸ª `impl` å—æ˜¯ä¸“é—¨ä¸º `UserDatabase` ç±»å‹å®šä¹‰æ–¹æ³•çš„ã€‚
impl UserDatabase {
    // `new` æ˜¯ä¸€ä¸ªå…³è”å‡½æ•°ï¼ˆAssociated Functionï¼‰ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ `&self` å‚æ•°ã€‚
    // å®ƒé€šå¸¸ç”¨ä½œæ„é€ å‡½æ•°ã€‚é€šè¿‡ `UserDatabase::new()` æ¥è°ƒç”¨ã€‚
    fn new() -> Self {
        UserDatabase { users: Vec::new() } // è¿”å›ä¸€ä¸ªæ–°çš„ã€ç©ºçš„ UserDatabase å®ä¾‹
    }

    // `add_user` æ–¹æ³•æ¥æ”¶ `&mut self` å’Œä¸€ä¸ª `User`ã€‚
    // `&mut self` è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•éœ€è¦å¯å˜åœ°å€Ÿç”¨è‡ªèº«ï¼Œå› ä¸ºå®ƒå°†è¦ä¿®æ”¹ `self.users`ã€‚
    // `user: User` è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•è·å–äº† `user` å‚æ•°çš„æ‰€æœ‰æƒï¼ˆOwnershipï¼‰ã€‚
    // å½“ `user` è¢«ä¼ å…¥åï¼Œå®ƒåœ¨å¤–éƒ¨å°±ä¸èƒ½å†è¢«ä½¿ç”¨äº†ï¼Œå®ƒçš„æ‰€æœ‰æƒè¢«â€œç§»åŠ¨â€åˆ°äº† `users` è¿™ä¸ª Vec ä¸­ã€‚
    fn add_user(&mut self, user: User) {
        self.users.push(user);
    }

    // --- 7. ç”Ÿå‘½å‘¨æœŸ (Lifetimes) ---
    // è¿™ä¸ªæ–¹æ³•æ¼”ç¤ºäº†ç”Ÿå‘½å‘¨æœŸå’Œ `Option` ç±»å‹ã€‚
    // `&self` è¡¨æ˜æˆ‘ä»¬åªæ˜¯ä¸å¯å˜åœ°å€Ÿç”¨æ•°æ®åº“ï¼Œå› ä¸ºæˆ‘ä»¬åªæŸ¥æ‰¾ï¼Œä¸ä¿®æ”¹ã€‚
    // è¿”å›ç±»å‹ `Option<&User>` è¡¨ç¤ºï¼š
    //  - `Option`: æˆ‘ä»¬å¯èƒ½æ‰¾åˆ°ç”¨æˆ·ï¼Œä¹Ÿå¯èƒ½æ‰¾ä¸åˆ°ã€‚`Some` è¡¨ç¤ºæ‰¾åˆ°ï¼Œ`None` è¡¨ç¤ºæ²¡æ‰¾åˆ°ã€‚
    //  - `&User`: å¦‚æœæ‰¾åˆ°äº†ï¼Œæˆ‘ä»¬è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹æ•°æ®åº“ä¸­ `User` çš„**å¼•ç”¨**ï¼Œè€Œä¸æ˜¯ `User` æœ¬èº«æˆ–å…¶æ‹·è´ã€‚
    //             è¿™æ ·å¯ä»¥é¿å…ä¸å¿…è¦çš„æ•°æ®å¤åˆ¶ï¼Œéå¸¸é«˜æ•ˆã€‚
    //
    // `fn find_user_by_id<'a>(&'a self, id: u32) -> Option<&'a User>`
    // ä¸Šé¢æ˜¯å¸¦æœ‰æ˜¾å¼ç”Ÿå‘½å‘¨æœŸæ³¨è§£çš„å‡½æ•°ç­¾åã€‚`'a` (è¯»ä½œ tick A) æ˜¯ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‚æ•°ã€‚
    // å®ƒå‘Šè¯‰ Rust ç¼–è¯‘å™¨ï¼šè¿”å›çš„ `&User` å¼•ç”¨çš„å­˜æ´»æ—¶é—´ï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰ä¸èƒ½è¶…è¿‡ `&self` å¼•ç”¨çš„å­˜æ´»æ—¶é—´ã€‚
    // æ¢å¥è¯è¯´ï¼Œåªè¦ `UserDatabase` å®ä¾‹è¿˜å­˜åœ¨ï¼Œè¿”å›çš„ `&User` å¼•ç”¨å°±æ˜¯æœ‰æ•ˆçš„ã€‚
    // åœ¨è¿™ä¸ªç®€å•çš„ä¾‹å­ä¸­ï¼Œç¼–è¯‘å™¨å¯ä»¥è‡ªåŠ¨æ¨æ–­ï¼ˆç§°ä¸ºâ€œç”Ÿå‘½å‘¨æœŸçœç•¥è§„åˆ™â€ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨å†™ `'a`ã€‚
    // ä½†ç†è§£è¿™ä¸ªæ¦‚å¿µå¯¹äºç¼–å†™å¤æ‚çš„ Rust ç¨‹åºè‡³å…³é‡è¦ã€‚
    fn find_user_by_id(&self, id: u32) -> Option<&User> {
        // `.iter()` æ–¹æ³•è¿”å›ä¸€ä¸ªé›†åˆçš„è¿­ä»£å™¨ã€‚
        // `.find()` æ˜¯è¿­ä»£å™¨çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªé—­åŒ…ï¼ˆclosureï¼‰ã€‚
        // å®ƒä¼šéå†æ¯ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªä½¿é—­åŒ…è¿”å› `true` çš„å…ƒç´ çš„å¼•ç”¨ã€‚
        self.users.iter().find(|user| user.id == id)
    }

    // --- 8. è¿­ä»£å™¨ (Iterators) ä¸ é—­åŒ… (Closures) ---
    // è¿™ä¸ªæ–¹æ³•å±•ç¤ºäº† Rust å¼ºå¤§çš„è¿­ä»£å™¨å’Œé—­åŒ…ç»„åˆã€‚
    // `-> Vec<&User>` è¡¨ç¤ºè¿”å›ä¸€ä¸ªåŒ…å« `User` å¼•ç”¨çš„ Vecã€‚
    fn list_active_users(&self) -> Vec<&User> {
        self.users
            .iter() // 1. è·å– `users` Vec çš„ä¸€ä¸ªä¸å¯å˜è¿­ä»£å™¨ã€‚
            // 2. `.filter()` æ˜¯ä¸€ä¸ªè¿­ä»£å™¨é€‚é…å™¨ï¼ˆadapterï¼‰ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªé—­åŒ…ã€‚
            //    å®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ï¼ŒåªåŒ…å«è®©é—­åŒ…è¿”å› `true` çš„å…ƒç´ ã€‚
            //    `|u| ...` å°±æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œä¸€ä¸ªå¯ä»¥æ•è·å…¶ç¯å¢ƒçš„åŒ¿åå‡½æ•°ã€‚
            //    `u` æ˜¯è¿­ä»£å™¨ä¸­çš„æ¯ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œè¿™é‡Œæ˜¯ `&&User`ï¼Œé€šè¿‡ `*u` è§£å¼•ç”¨ä¸€æ¬¡å¾—åˆ° `&User`ã€‚
            .filter(|u| u.status == UserStatus::Active)
            // 3. `.collect()` æ˜¯ä¸€ä¸ªæ¶ˆè´¹å™¨ï¼ˆconsumerï¼‰ï¼Œå®ƒä¼šæ¶ˆè€—è¿­ä»£å™¨ï¼Œ
            //    å¹¶å°†ç»“æœæ”¶é›†åˆ°ä¸€ä¸ªæ–°çš„é›†åˆä¸­ã€‚Rust ä¼šæ ¹æ®è¿”å›ç±»å‹ `Vec<&User>` æ¨æ–­å‡ºè¦æ”¶é›†æˆä»€ä¹ˆã€‚
            .collect()
    }
}

// --- ç¨‹åºä¸»å‡½æ•°ï¼Œæ¼”ç¤ºç”¨æ³• ---
fn main() {
    // åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·æ•°æ®åº“
    let mut db = UserDatabase::new();

    // åˆ›å»ºå‡ ä¸ªç”¨æˆ·ã€‚æ³¨æ„ `Banned` çŠ¶æ€çš„ç”¨æ³•ã€‚
    let user1 = User { id: 1, username: "Alice".to_string(), status: UserStatus::Active };
    let user2 = User { id: 2, username: "Bob".to_string(), status: UserStatus::Inactive };
    let user3 = User { id: 3, username: "Charlie".to_string(), status: UserStatus::Banned("Spamming".to_string()) };
    let user4 = User { id: 4, username: "David".to_string(), status: UserStatus::Active };
    
    // æ·»åŠ ç”¨æˆ·åˆ°æ•°æ®åº“ã€‚æ³¨æ„ `user1` ç­‰å˜é‡çš„æ‰€æœ‰æƒè¢«ç§»åŠ¨äº†ã€‚
    // åœ¨è¿™ä¹‹åï¼Œä½ å°±ä¸èƒ½å†ç›´æ¥ä½¿ç”¨ `user1` è¿™ä¸ªå˜é‡äº†ï¼Œå› ä¸ºå®ƒå·²ç»ä¸â€œæ‹¥æœ‰â€æ•°æ®äº†ã€‚
    db.add_user(user1);
    db.add_user(user2);
    db.add_user(user3);
    db.add_user(user4);
    
    // æ¼”ç¤ºæŸ¥æ‰¾ç”¨æˆ·å’Œ `Option` çš„å¤„ç†
    let search_id = 3;
    println!("Finding user with ID: {}", search_id);
    // `if let` æ˜¯å¤„ç† `Option` æˆ– `Result` çš„ä¸€ç§éå¸¸ä¼˜é›…çš„æ–¹å¼ã€‚
    // å¦‚æœ `find_user_by_id` è¿”å› `Some(user)`ï¼Œé‚£ä¹ˆ `user` å˜é‡å°±ä¼šè¢«ç»‘å®šåˆ° `Some` é‡Œçš„å€¼ï¼Œ
    // å¹¶ä¸”ä»£ç å—ä¼šè¢«æ‰§è¡Œã€‚å¦‚æœè¿”å› `None`ï¼Œåˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚
    if let Some(found_user) = db.find_user_by_id(search_id) {
        // è°ƒç”¨ `Summarizable` trait æä¾›çš„æ–¹æ³•
        println!("  Found: {}", found_user.summary());
    } else {
        println!("  User not found.");
    }

    // æ¼”ç¤ºæŸ¥æ‰¾ä¸å­˜åœ¨çš„ç”¨æˆ·
    println!("\nFinding user with ID: 99");
    if let Some(found_user) = db.find_user_by_id(99) {
        println!("  Found: {}", found_user.summary());
    } else {
        println!("  User not found.");
    }
    
    // æ¼”ç¤ºè¿­ä»£å™¨å’Œé—­åŒ…
    println!("\nListing active users:");
    let active_users = db.list_active_users();
    for user in active_users {
        println!("  - {}", user.summary());
    }
}
```

---

# ä¸‹é¢å°±çœŸçš„æ˜¯å­¦ä¹ ç¬”è®°äº†ï¼

## 1. å¸¸è§ç¼–ç¨‹æ¦‚å¿µ

### 1.1 `mut` & é®è”½ï¼ˆShadowingï¼‰

é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥æ¸…æ™°åœ°å¯¹æ¯” `mut` å’Œé®è”½ï¼š

| ç‰¹æ€§ | `mut` (å¯å˜æ€§) | é®è”½ (Shadowing) |
| :--- | :--- | :--- |
| **æœ¬è´¨** | ä¿®æ”¹**åŒä¸€ä¸ª**å˜é‡ç»‘å®šçš„å€¼ | åˆ›å»ºä¸€ä¸ªä¸æ—§å˜é‡**åŒåçš„æ–°**å˜é‡ï¼Œ"é®è”½"æ—§çš„ |
| **å†…å­˜** | é€šå¸¸åœ¨åŒä¸€å—å†…å­˜åœ°å€ä¸Šä¿®æ”¹æ•°æ® | åˆ›å»ºæ–°çš„å†…å­˜ç©ºé—´ï¼ˆæˆ–å¼•ç”¨ï¼‰æ¥å­˜æ”¾æ–°å€¼ |
| **ç±»å‹** | å˜é‡çš„ç±»å‹**ä¸èƒ½**æ”¹å˜ | æ–°å˜é‡çš„ç±»å‹**å¯ä»¥**ä¸æ—§å˜é‡ä¸åŒ |
| **ä½œç”¨åŸŸ** | åœ¨æ•´ä¸ªä½œç”¨åŸŸå†…éƒ½æ˜¯å¯å˜çš„ | æ–°å˜é‡çš„ä½œç”¨åŸŸä»å£°æ˜å¤„å¼€å§‹ï¼Œæ—§å˜é‡è¢«æš‚æ—¶éšè— |
| **ä¸å¯å˜æ€§** | ç ´åäº†å˜é‡çš„ä¸å¯å˜æ€§ | é‡æ–°ç»‘å®šåï¼Œæ–°å˜é‡æœ¬èº«ä»ç„¶æ˜¯**ä¸å¯å˜**çš„ï¼ˆé™¤éä¹Ÿå£°æ˜ä¸º`mut`ï¼‰ |

#### ä½•æ—¶åº”è¯¥ä½¿ç”¨ `mut`ï¼Ÿ

**æ ¸å¿ƒåŸåˆ™ï¼šå½“ä½ éœ€è¦æ”¹å˜ä¸€ä¸ªå˜é‡çš„â€œçŠ¶æ€â€ï¼Œè€Œä¸æ˜¯å®ƒçš„â€œæœ¬è´¨â€æ—¶ï¼Œä½¿ç”¨ `mut`ã€‚**

è¿™é€šå¸¸å‘ç”Ÿåœ¨åŒä¸€ä¸ªé€»è¾‘å®ä½“éœ€è¦åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…ç»å†çŠ¶æ€å˜åŒ–çš„æƒ…å†µä¸‹ã€‚

**A. å¾ªç¯ä¸­çš„è®¡æ•°å™¨æˆ–ç´¯åŠ å™¨**
è¿™æ˜¯ `mut` æœ€ç»å…¸ã€æœ€ç›´è§‚çš„ç”¨ä¾‹ã€‚ä½ æ­£åœ¨å¯¹åŒä¸€ä¸ªâ€œè®¡æ•°å™¨â€è¿›è¡Œç´¯åŠ æ“ä½œã€‚

```rust
let mut count = 0;
while count < 5 {
    println!("Count is: {}", count);
    count += 1; // è¿™é‡Œåœ¨ä¿®æ”¹ count çš„çŠ¶æ€
}
```

**B. é€æ­¥æ„å»ºä¸€ä¸ªå€¼ï¼ˆä¾‹å¦‚ `String` æˆ– `Vec`ï¼‰**
å½“ä½ åœ¨ä¸€ä¸ªå®¹å™¨ä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œä½ æ˜¯åœ¨ä¿®æ”¹è¿™ä¸ªå®¹å™¨çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å®¹å™¨ã€‚

```rust
let mut names = Vec::new();
names.push("Alice");
names.push("Bob");
names.push("Charlie"); // è¿ç»­ä¿®æ”¹ names çš„å†…éƒ¨çŠ¶æ€
```

**C. ä¿®æ”¹ç»“æ„ä½“çš„å­—æ®µ**
å½“ä½ éœ€è¦æ›´æ–°ä¸€ä¸ªå®ä¾‹çš„æŸä¸ªå±æ€§æ—¶ï¼Œè¿™ä¸ªå®ä¾‹ä»ç„¶æ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼Œåªæ˜¯å…¶å†…éƒ¨çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ã€‚

```rust
struct User {
    name: String,
    login_count: u32,
}

let mut user = User { name: "Alice".to_string(), login_count: 1 };
println!("{} has logged in {} time(s)", user.name, user.login_count);

user.login_count += 1; // ä¿®æ”¹åŒä¸€ä¸ª user å®ä¾‹çš„çŠ¶æ€
println!("After another login: {}", user.login_count);
```

**ä½¿ç”¨ `mut` çš„ä¼˜åŠ¿ï¼š**

  * **æ€§èƒ½ï¼š** å¯¹äºå¤æ‚çš„æ•°æ®ç»“æ„ï¼ˆå¦‚ `Vec`ï¼‰ï¼ŒåŸåœ°ä¿®æ”¹é€šå¸¸æ¯”åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å‰¯æœ¬æ›´é«˜æ•ˆã€‚
  * **ç›´è§‚ï¼š** å½“é€»è¾‘ä¸Šæ˜¯â€œçŠ¶æ€å˜æ›´â€æ—¶ï¼Œä½¿ç”¨ `mut` æ›´ç¬¦åˆäººçš„ç›´è§‰ã€‚

#### ä½•æ—¶åº”è¯¥ä½¿ç”¨é®è”½ï¼ˆShadowingï¼‰ï¼Ÿ

**æ ¸å¿ƒåŸåˆ™ï¼šå½“ä½ éœ€è¦å¯¹ä¸€ä¸ªå€¼è¿›è¡Œâ€œè½¬æ¢â€æˆ–â€œé‡æ–°å®šä¹‰â€ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠç±»å‹æ”¹å˜æ—¶ï¼Œä½¿ç”¨é®è”½ã€‚**

é®è”½çš„ç²¾é«“åœ¨äºï¼Œä½ ä¸å†å…³å¿ƒé‚£ä¸ªæ—§çš„å€¼äº†ï¼Œæ–°çš„åŒåå˜é‡æ‰æ˜¯ä½ æ¥ä¸‹æ¥è¦ä½¿ç”¨çš„ã€‚è¿™ä¿æŒäº†â€œé»˜è®¤ä¸å¯å˜â€çš„å“²å­¦ã€‚

**A. ç±»å‹è½¬æ¢**
è¿™æ˜¯é®è”½æœ€å¼ºå¤§ã€æœ€å¸¸è§çš„ç”¨é€”ã€‚ä½ å¯ä»¥é‡ç”¨ä¸€ä¸ªæœ‰æ„ä¹‰çš„å˜é‡åï¼ŒåŒæ—¶æ”¹å˜å®ƒçš„ç±»å‹ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚

```rust
let input = "  42  "; // input æ˜¯ &str ç±»å‹

// è½¬æ¢1ï¼šå»é™¤ç©ºç™½ï¼Œä»ç„¶æ˜¯ &strï¼Œä½†å€¼å˜äº†
let input = input.trim(); 

// è½¬æ¢2ï¼šè§£æä¸ºæ•°å­—ï¼Œç±»å‹å˜ä¸º u32
let input: u32 = match input.parse() {
    Ok(num) => num,
    Err(_) => {
        println!("Please type a number!");
        return;
    }
};

println!("The number is: {}", input);
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœä¸ç”¨é®è”½ï¼Œä½ å¯èƒ½éœ€è¦å†™æˆ `input_str`, `trimmed_input`, `input_num` è¿™æ ·ï¼Œæ—¢å•°å—¦åˆå®¹æ˜“æ··æ·†ã€‚é®è”½è®©ä½ å§‹ç»ˆä½¿ç”¨ `input` è¿™ä¸ªæœ€è´´åˆ‡çš„åå­—ã€‚

**B. â€œè§£åŒ…â€æ“ä½œï¼ˆUnwrappingï¼‰**
ä» `Option` æˆ– `Result` ä¸­å–å‡ºå†…éƒ¨å€¼åï¼Œä½ é€šå¸¸åªå…³å¿ƒé‚£ä¸ªå†…éƒ¨å€¼ã€‚

```rust
let some_value: Option<i32> = Some(5);

// æ—§çš„ some_value æ˜¯ Option<i32> ç±»å‹
// æ–°çš„ some_value æ˜¯ i32 ç±»å‹
let some_value = some_value.expect("Value should exist"); 

// æ­¤åçš„ä»£ç éƒ½ç›´æ¥ä½¿ç”¨ i32 ç±»å‹çš„ some_value
println!("The value is {}", some_value);
```

**C. ä¿æŒä¸å¯å˜æ€§**
å½“ä½ è¿›è¡Œä¸€æ¬¡æ€§è½¬æ¢åï¼Œä¸å¸Œæœ›è¿™ä¸ªæ–°å€¼å†è¢«æ„å¤–ä¿®æ”¹æ—¶ï¼Œé®è”½éå¸¸æœ‰ç”¨ã€‚

```rust
let message = "hello"; // ä¸å¯å˜

// è¿›è¡Œä¸€æ¬¡è½¬æ¢ï¼Œè½¬æ¢åçš„ message ä»ç„¶æ˜¯ä¸å¯å˜çš„
let message = message.len(); // message ç°åœ¨æ˜¯ usize ç±»å‹

// message = 6; // ç¼–è¯‘é”™è¯¯ï¼å› ä¸ºæ–°çš„ message é»˜è®¤æ˜¯ä¸å¯å˜çš„
```

å¦‚æœè¿™é‡Œç”¨ `mut`ï¼Œä½ éœ€è¦å…ˆå£°æ˜ `let mut message = "hello";`ï¼Œç„¶ååœ¨ä¸­é€”æ”¹å˜å®ƒçš„å€¼å’Œç±»å‹ï¼ˆå¦‚æœå¯èƒ½çš„è¯ï¼‰ï¼Œè¿™ä¼šä½¿å˜é‡åœ¨ä¸éœ€è¦å¯å˜æ€§çš„åœ°æ–¹ä¹Ÿå˜å¾—å¯å˜ï¼Œå¢åŠ äº†å‡ºé”™çš„é£é™©ã€‚

#### è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„å†³ç­–æµç¨‹å¯ä»¥éµå¾ªï¼š

1.  **æˆ‘éœ€è¦æ”¹å˜å€¼çš„ç±»å‹å—ï¼Ÿ**

      * **æ˜¯** -> **å¿…é¡»ä½¿ç”¨é®è”½**ã€‚è¿™æ˜¯ `mut` æ— æ³•åšåˆ°çš„ã€‚
      * **å¦** -> è¿›å…¥ä¸‹ä¸€æ­¥ã€‚

2.  **æˆ‘æ˜¯åœ¨è¿›è¡Œä¸€æ¬¡æ€§çš„â€œè½¬æ¢â€ï¼Œä¹‹åå°±ä¸å†éœ€è¦æ—§çš„å€¼äº†å—ï¼Ÿ**

      * **æ˜¯** -> **ä¼˜å…ˆè€ƒè™‘é®è”½**ã€‚ä¾‹å¦‚ `let x = x + 1;` æˆ– `let s = s.trim();`ã€‚è¿™æ ·åšå¯ä»¥ä¿æŒå˜é‡åœ¨è½¬æ¢åä¾ç„¶æ˜¯ä¸å¯å˜çš„ï¼Œæ›´å®‰å…¨ã€‚
      * **å¦** -> è¿›å…¥ä¸‹ä¸€æ­¥ã€‚

3.  **æˆ‘æ˜¯åœ¨ä¸€ä¸ªå¾ªç¯ä¸­æˆ–ä¸€ä¸ªç®—æ³•é‡Œï¼Œéœ€è¦åå¤ä¿®æ”¹åŒä¸€ä¸ªå˜é‡çš„â€œçŠ¶æ€â€å—ï¼Ÿ**

      * **æ˜¯** -> **ä¼˜å…ˆè€ƒè™‘ `mut`**ã€‚ä¾‹å¦‚ç´¯åŠ å™¨ã€æ„å»º `Vec` ç­‰ã€‚è¿™åœ¨æ€§èƒ½å’Œæ„å›¾ä¸Šéƒ½æ›´æ¸…æ™°ã€‚
      * **å¦** -> é‡æ–°å®¡è§†ä½ çš„é€»è¾‘ï¼Œé€šå¸¸ `mut` å’Œé®è”½çš„ç•Œé™å·²ç»å¾ˆæ¸…æ™°äº†ã€‚

**ä¸€ä¸ªé»„é‡‘æ³•åˆ™ï¼š**

> **å¦‚æœä½ èƒ½ç”¨é®è”½ï¼Œå¹¶ä¸”å®ƒèƒ½è®©ä½ çš„ä»£ç æ›´æ¸…æ™°ï¼ˆå°¤å…¶æ˜¯æ¶‰åŠç±»å‹è½¬æ¢æ—¶ï¼‰ï¼Œé‚£å°±ç”¨é®è”½ã€‚å¦åˆ™ï¼Œå½“ä½ ç¡®å®éœ€è¦åŸåœ°ä¿®æ”¹çŠ¶æ€æ—¶ï¼Œæ‰ä½¿ç”¨ `mut`ã€‚**

Rust çš„è®¾è®¡é¼“åŠ±ä½ å°½å¯èƒ½åœ°ä½¿ç”¨ä¸å¯å˜æ€§ã€‚é®è”½æ˜¯å®ç°è¿™ä¸€ç›®æ ‡åŒæ—¶åˆä¸å¤±ä¾¿åˆ©æ€§çš„å¼ºå¤§å·¥å…·ã€‚å®ƒå…è®¸ä½ å¯¹æ•°æ®è¿›è¡Œå˜æ¢ï¼Œå¹¶ç«‹å³å°†ç»“æœé‡æ–°ç»‘å®šåˆ°ä¸å¯å˜çš„å˜é‡ä¸Šï¼Œä»è€Œå°†â€œå¯å˜â€çš„çª—å£æœŸç¼©åˆ°æœ€å°ã€‚è€Œ `mut` åˆ™æ˜¯å¯¹â€œè¿™é‡Œç¡®å®éœ€è¦çŠ¶æ€å˜åŒ–â€è¿™ä¸€äº‹å®çš„ä¸€ä¸ªæ˜ç¡®æ ‡è®°ã€‚

### 1.2 å¤åˆç±»å‹

#### å…ƒç»„

* **ä½œç”¨**ï¼šæŠŠ**å¤šä¸ªå¯èƒ½ä¸åŒç±»å‹**çš„å€¼ç»„åˆæˆä¸€ä¸ªå¤åˆç±»å‹
* **é•¿åº¦**ï¼š**å›ºå®š**ï¼Œå£°æ˜åä¸èƒ½å¢å‡
* **ç±»å‹**ï¼šæ¯ä¸ªä½ç½®**ç±»å‹ç‹¬ç«‹**ï¼Œä½ç½®å³è¯­ä¹‰
* **åˆ›å»ºæ–¹å¼**ï¼š`(v1, v2, v3, ...)`
* **è®¿é—®æ–¹å¼**ï¼š

  1. **è§£æ„ï¼ˆdestructuringï¼‰**
  2. **ç‚¹å· + ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰**
* **ç‰¹æ®Šå…ƒç»„**ï¼š`()`

  * ç§°ä¸º **unit**
  * è¡¨ç¤ºâ€œæ²¡æœ‰æœ‰æ„ä¹‰çš„è¿”å›å€¼â€

**å®šä¹‰å…ƒç»„ï¼ˆå«ç±»å‹æ³¨è§£ï¼‰**

```rust
let tup: (i32, f64, u8) = (500, 6.4, 1);
```

**è§£æ„å…ƒç»„ï¼ˆæœ€å¸¸ç”¨ï¼‰**

```rust
let tup = (500, 6.4, 1);
let (x, y, z) = tup;

println!("{y}"); // 6.4
```

**è®°å¿†ç‚¹**ï¼š

> ç”¨ `let (a, b, c) = tuple;` æ‹†åŒ…

**ç´¢å¼•è®¿é—®å…ƒç»„**

```rust
let x = (500, 6.4, 1);

let a = x.0;
let b = x.1;
let c = x.2;
```

**è®°å¿†ç‚¹**ï¼š

> å…ƒç»„è®¿é—®ç”¨ `.`ï¼Œä¸æ˜¯ `[]`

#### æ•°ç»„

* **å…ƒç´ ç±»å‹**ï¼š**å¿…é¡»ç›¸åŒ**
* **é•¿åº¦**ï¼š**å›ºå®š**
* **å†…å­˜ç‰¹æ€§**ï¼šé€šå¸¸åˆ†é…åœ¨ **æ ˆï¼ˆstackï¼‰**
* **é€‚ç”¨åœºæ™¯**ï¼š

  * å…ƒç´ æ•°é‡**ç¡®å®šä¸”ä¸å˜**
  * æ¯” `Vec` æ›´ä¸¥æ ¼ã€æ›´å®‰å…¨
* **å¯¹æ¯”**ï¼š

  * `array`ï¼šå®šé•¿
  * `Vec`ï¼šå¯å˜é•¿ï¼ˆæ›´å¸¸ç”¨ï¼‰

**åˆ›å»ºæ•°ç»„**

```rust
let a = [1, 2, 3, 4, 5];
```

**æ˜¾å¼ç±»å‹ä¸é•¿åº¦**

```rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
```

**é‡å¤å€¼åˆå§‹åŒ–**

```rust
let a = [3; 5]; // ç­‰ä»·äº [3, 3, 3, 3, 3]
```

**è®¿é—®æ•°ç»„å…ƒç´ **

```rust
let a = [1, 2, 3, 4, 5];

let first = a[0];
let second = a[1];
```

**é€‚åˆç”¨æ•°ç»„çš„çœŸå®åœºæ™¯**

```rust
let months = [
    "January", "February", "March", "April",
    "May", "June", "July", "August",
    "September", "October", "November", "December",
];
```

**è®°å¿†ç‚¹**ï¼š

> æ•°é‡å›ºå®š â†’ ç”¨æ•°ç»„ï¼Œä¸ç”¨ `Vec`

### 1.3 æ ‡é‡ï¼ˆScalar Typesï¼‰

Rust çš„æ ‡é‡ç±»å‹åŒ…å«å››ç±»ï¼š**æ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”å‹ã€å­—ç¬¦å‹**ã€‚å®ƒä»¬è¡¨ç¤ºå•ä¸€å€¼ã€‚

#### æ•´å‹ï¼ˆInteger Typesï¼‰

| é•¿åº¦      | æœ‰ç¬¦å·   | æ— ç¬¦å·   |
| ------- | ----- | ----- |
| 8-bit   | i8    | u8    |
| 16-bit  | i16   | u16   |
| 32-bit  | i32   | u32   |
| 64-bit  | i64   | u64   |
| 128-bit | i128  | u128  |
| ä¾èµ–æ¶æ„    | isize | usize |

* æœ‰ç¬¦å·ç±»å‹ä»¥è¡¥ç è¡¨ç¤ºã€‚
* æœ‰ç¬¦å·èŒƒå›´ï¼š`-(2^(n-1))` è‡³ `2^(n-1)-1`
  ä¾‹å¦‚ï¼š`i8 âˆˆ [-128, 127]`
* æ— ç¬¦å·èŒƒå›´ï¼š`0` è‡³ `2^n - 1`
  ä¾‹å¦‚ï¼š`u8 âˆˆ [0, 255]`

é»˜è®¤æ•´å‹ä¸º **i32**ã€‚

| æ ¼å¼          | ç¤ºä¾‹            |
| ----------- | ------------- |
| åè¿›åˆ¶         | `98_222`      |
| åå…­è¿›åˆ¶        | `0xff`        |
| å…«è¿›åˆ¶         | `0o77`        |
| äºŒè¿›åˆ¶         | `0b1111_0000` |
| å­—èŠ‚å­—é¢å€¼ï¼ˆä»… u8ï¼‰ | `b'A'`        |

å¯ä½¿ç”¨ `_` å¢å¼ºå¯è¯»æ€§ã€‚

#### æµ®ç‚¹å‹ï¼ˆFloating-Point Typesï¼‰

Rust æä¾›ä¸¤ç§æµ®ç‚¹å‹ï¼ˆéµå¾ª IEEE-754ï¼‰ï¼š

* `f32`ï¼šå•ç²¾åº¦
* `f64`ï¼ˆé»˜è®¤ï¼‰ï¼šåŒç²¾åº¦

ç¤ºä¾‹ï¼š

```rust
let x = 2.0;     // f64
let y: f32 = 3.0; // f32
```

#### å¸ƒå°”ç±»å‹ï¼ˆboolï¼‰

ä¸¤ä¸ªå€¼ï¼š`true`ã€`false`ã€‚

ç¤ºä¾‹ï¼š

```rust
let t = true;
let f: bool = false;
```

å¸ƒå°”å€¼å¸¸ç”¨äº `if` è¡¨è¾¾å¼ã€‚

#### å­—ç¬¦ç±»å‹ï¼ˆcharï¼‰

* ä½¿ç”¨å•å¼•å·è¡¨ç¤ºï¼Œå¦‚ï¼š`'z'`ã€`'â„¤'`ã€`'ğŸ˜»'`
* å  **4 å­—èŠ‚**
* è¡¨ç¤º Unicode æ ‡é‡å€¼ï¼ˆé ASCIIï¼‰ã€‚

æœ‰æ•ˆèŒƒå›´ï¼š`U+0000..=U+D7FF` å’Œ `U+E000..=U+10FFFF`

## 2. è®¤è¯†æ‰€æœ‰æƒ

### 2.1 æ ˆï¼ˆStackï¼‰ä¸å †ï¼ˆHeapï¼‰

åœ¨å¾ˆå¤šè¯­è¨€ä¸­ï¼Œä½ å¹¶ä¸éœ€è¦ç»å¸¸è€ƒè™‘åˆ°æ ˆä¸å †ã€‚ä¸è¿‡åœ¨åƒ Rust è¿™æ ·çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå€¼æ˜¯ä½äºæ ˆä¸Šè¿˜æ˜¯å †ä¸Šåœ¨æ›´å¤§ç¨‹åº¦ä¸Šå½±å“äº†è¯­è¨€çš„è¡Œä¸ºä»¥åŠä¸ºä½•å¿…é¡»åšå‡ºè¿™æ ·çš„æŠ‰æ‹©ã€‚æˆ‘ä»¬ä¼šåœ¨æœ¬ç« çš„ç¨åéƒ¨åˆ†æè¿°æ‰€æœ‰æƒä¸æ ˆå’Œå †ç›¸å…³çš„å†…å®¹ï¼Œæ‰€ä»¥è¿™é‡Œåªæ˜¯ä¸€ä¸ªç”¨æ¥é¢„çƒ­çš„ç®€è¦è§£é‡Šã€‚

æ ˆå’Œå †éƒ½æ˜¯ä»£ç åœ¨è¿è¡Œæ—¶å¯ä¾›ä½¿ç”¨çš„å†…å­˜ï¼Œä½†æ˜¯å®ƒä»¬çš„ç»“æ„ä¸åŒã€‚æ ˆä»¥æ”¾å…¥å€¼çš„é¡ºåºå­˜å‚¨å€¼å¹¶ä»¥ç›¸åé¡ºåºå–å‡ºå€¼ã€‚è¿™ä¹Ÿè¢«ç§°ä½œ åè¿›å…ˆå‡ºï¼ˆlast in, first outï¼‰ã€‚æƒ³è±¡ä¸€ä¸‹ä¸€å ç›˜å­ï¼šå½“å¢åŠ æ›´å¤šç›˜å­æ—¶ï¼ŒæŠŠå®ƒä»¬æ”¾åœ¨ç›˜å­å †çš„é¡¶éƒ¨ï¼Œå½“éœ€è¦ç›˜å­æ—¶ï¼Œä¹Ÿä»é¡¶éƒ¨æ‹¿èµ°ã€‚ä¸èƒ½ä»ä¸­é—´ä¹Ÿä¸èƒ½ä»åº•éƒ¨å¢åŠ æˆ–æ‹¿èµ°ç›˜å­ï¼å¢åŠ æ•°æ®å«åš å…¥æ ˆï¼ˆpushing onto the stackï¼‰ï¼Œè€Œç§»å‡ºæ•°æ®å«åš å‡ºæ ˆï¼ˆpopping off the stackï¼‰ã€‚æ ˆä¸­çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»å ç”¨å·²çŸ¥ä¸”å›ºå®šçš„å¤§å°ã€‚åœ¨ç¼–è¯‘æ—¶å¤§å°æœªçŸ¥æˆ–å¤§å°å¯èƒ½å˜åŒ–çš„æ•°æ®ï¼Œè¦æ”¹ä¸ºå­˜å‚¨åœ¨å †ä¸Šã€‚

å †æ˜¯ç¼ºä¹ç»„ç»‡çš„ï¼šå½“å‘å †æ”¾å…¥æ•°æ®æ—¶ï¼Œä½ è¦è¯·æ±‚ä¸€å®šå¤§å°çš„ç©ºé—´ã€‚å†…å­˜åˆ†é…å™¨ï¼ˆmemory allocatorï¼‰åœ¨å †çš„æŸå¤„æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºä½ï¼ŒæŠŠå®ƒæ ‡è®°ä¸ºå·²ä½¿ç”¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªè¡¨ç¤ºè¯¥ä½ç½®åœ°å€çš„ æŒ‡é’ˆï¼ˆpointerï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä½œ åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼ˆallocating on the heapï¼‰ï¼Œæœ‰æ—¶ç®€ç§°ä¸º â€œåˆ†é…â€ï¼ˆallocatingï¼‰ã€‚ï¼ˆå°†æ•°æ®æ¨å…¥æ ˆä¸­å¹¶ä¸è¢«è®¤ä¸ºæ˜¯åˆ†é…ï¼‰ã€‚å› ä¸ºæŒ‡å‘æ”¾å…¥å †ä¸­æ•°æ®çš„æŒ‡é’ˆæ˜¯å·²çŸ¥çš„å¹¶ä¸”å¤§å°æ˜¯å›ºå®šçš„ï¼Œä½ å¯ä»¥å°†è¯¥æŒ‡é’ˆå­˜å‚¨åœ¨æ ˆä¸Šï¼Œä¸è¿‡å½“éœ€è¦å®é™…æ•°æ®æ—¶ï¼Œå¿…é¡»è®¿é—®æŒ‡é’ˆã€‚æƒ³è±¡ä¸€ä¸‹å»é¤é¦†å°±åº§åƒé¥­ã€‚å½“è¿›å…¥æ—¶ï¼Œä½ è¯´æ˜æœ‰å‡ ä¸ªäººï¼Œé¤é¦†å‘˜å·¥ä¼šæ‰¾åˆ°ä¸€ä¸ªå¤Ÿå¤§çš„ç©ºæ¡Œå­å¹¶é¢†ä½ ä»¬è¿‡å»ã€‚å¦‚æœæœ‰äººæ¥è¿Ÿäº†ï¼Œä»–ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¯¢é—®æ¥æ‰¾åˆ°ä½ ä»¬ååœ¨å“ªã€‚

å…¥æ ˆæ¯”åœ¨å †ä¸Šåˆ†é…å†…å­˜è¦å¿«ï¼Œå› ä¸ºï¼ˆå…¥æ ˆæ—¶ï¼‰åˆ†é…å™¨æ— éœ€ä¸ºå­˜å‚¨æ–°æ•°æ®å»æœç´¢å†…å­˜ç©ºé—´ï¼›å…¶ä½ç½®æ€»æ˜¯åœ¨æ ˆé¡¶ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨å †ä¸Šåˆ†é…å†…å­˜åˆ™éœ€è¦æ›´å¤šçš„å·¥ä½œï¼Œè¿™æ˜¯å› ä¸ºåˆ†é…å™¨å¿…é¡»é¦–å…ˆæ‰¾åˆ°ä¸€å—è¶³å¤Ÿå­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´ï¼Œå¹¶æ¥ç€åšä¸€äº›è®°å½•ä¸ºä¸‹ä¸€æ¬¡åˆ†é…åšå‡†å¤‡ã€‚

è®¿é—®å †ä¸Šçš„æ•°æ®æ¯”è®¿é—®æ ˆä¸Šçš„æ•°æ®æ…¢ï¼Œå› ä¸ºå¿…é¡»é€šè¿‡æŒ‡é’ˆæ¥è®¿é—®ã€‚ç°ä»£å¤„ç†å™¨åœ¨å†…å­˜ä¸­è·³è½¬è¶Šå°‘å°±è¶Šå¿«ã€‚ç»§ç»­ç±»æ¯”ï¼Œå‡è®¾æœ‰ä¸€ä¸ªæœåŠ¡å‘˜åœ¨é¤å…é‡Œå¤„ç†å¤šä¸ªæ¡Œå­çš„ç‚¹èœã€‚åœ¨ä¸€ä¸ªæ¡Œå­æŠ¥å®Œæ‰€æœ‰èœåå†ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªæ¡Œå­æ˜¯æœ€æœ‰æ•ˆç‡çš„ã€‚ä»æ¡Œå­ A å¬ä¸€ä¸ªèœï¼Œæ¥ç€æ¡Œå­ B å¬ä¸€ä¸ªèœï¼Œç„¶åå†æ¡Œå­ Aï¼Œç„¶åå†æ¡Œå­ B è¿™æ ·çš„æµç¨‹ä¼šæ›´åŠ ç¼“æ…¢ã€‚å‡ºäºåŒæ ·åŸå› ï¼Œå¤„ç†å™¨åœ¨å¤„ç†çš„æ•°æ®å½¼æ­¤è¾ƒè¿‘çš„æ—¶å€™ï¼ˆæ¯”å¦‚åœ¨æ ˆä¸Šï¼‰æ¯”è¾ƒè¿œçš„æ—¶å€™ï¼ˆæ¯”å¦‚å¯èƒ½åœ¨å †ä¸Šï¼‰æ›´é«˜æ•ˆã€‚

å½“ä½ çš„ä»£ç è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä¼ é€’ç»™å‡½æ•°çš„å€¼ï¼ˆåŒ…æ‹¬å¯èƒ½æŒ‡å‘å †ä¸Šæ•°æ®çš„æŒ‡é’ˆï¼‰å’Œå‡½æ•°çš„å±€éƒ¨å˜é‡è¢«å‹å…¥æ ˆä¸­ã€‚å½“å‡½æ•°ç»“æŸæ—¶ï¼Œè¿™äº›å€¼è¢«ç§»å‡ºæ ˆã€‚

è·Ÿè¸ªå“ªéƒ¨åˆ†ä»£ç æ­£åœ¨ä½¿ç”¨å †ä¸Šçš„å“ªäº›æ•°æ®ï¼Œæœ€å¤§é™åº¦çš„å‡å°‘å †ä¸Šçš„é‡å¤æ•°æ®çš„æ•°é‡ï¼Œä»¥åŠæ¸…ç†å †ä¸Šä¸å†ä½¿ç”¨çš„æ•°æ®ç¡®ä¿ä¸ä¼šè€—å°½ç©ºé—´ï¼Œè¿™äº›é—®é¢˜æ­£æ˜¯æ‰€æœ‰æƒç³»ç»Ÿè¦å¤„ç†çš„ã€‚ä¸€æ—¦ç†è§£äº†æ‰€æœ‰æƒï¼Œä½ å°±ä¸éœ€è¦ç»å¸¸è€ƒè™‘æ ˆå’Œå †äº†ï¼Œä¸è¿‡æ˜ç™½äº†æ‰€æœ‰æƒçš„ä¸»è¦ç›®çš„å°±æ˜¯ç®¡ç†å †æ•°æ®ï¼Œèƒ½å¤Ÿå¸®åŠ©è§£é‡Šä¸ºä»€ä¹ˆæ‰€æœ‰æƒè¦ä»¥è¿™ç§æ–¹å¼å·¥ä½œã€‚

### 2.2 æ‰€æœ‰æƒè§„åˆ™

- Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ª æ‰€æœ‰è€…ï¼ˆownerï¼‰ã€‚
- å€¼åœ¨ä»»ä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚
- å½“æ‰€æœ‰è€…ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒã€‚

### 2.3 æ‹·è´ä¸ç§»åŠ¨

* åŸºæœ¬ç±»å‹ï¼ˆå¦‚æ•´æ•°ï¼‰å…·æœ‰å›ºå®šå¤§å°ï¼Œå­˜å‚¨åœ¨æ ˆä¸Šï¼›èµ‹å€¼ä¼šå¤åˆ¶å…¶å€¼ï¼Œä¸¤ä¸ªå˜é‡äº’ä¸å½±å“ã€‚
* å¯¹äº `String` ç­‰å †åˆ†é…ç±»å‹ï¼Œèµ‹å€¼ä¼š *ç§»åŠ¨*ï¼šæ‹·è´æŒ‡é’ˆã€é•¿åº¦ã€å®¹é‡ï¼ŒåŒæ—¶ä½¿åŸå˜é‡å¤±æ•ˆã€‚
* Rust ä»ä¸è‡ªåŠ¨æ‰§è¡Œæ·±æ‹·è´ï¼›åªæœ‰æ˜¾å¼è°ƒç”¨ `.clone()` æ‰ä¼šå¤åˆ¶å †ä¸Šæ•°æ®ã€‚
* ç±»å‹è‹¥å®ç° `Copy` traitï¼Œèµ‹å€¼ååŸå˜é‡ä»ç„¶æœ‰æ•ˆã€‚
* åªæœ‰ä¸éœ€è¦è‡ªå®šä¹‰ææ„ä¸”å®Œå…¨æ ˆåˆ†é…çš„ç±»å‹æ‰å¯å®ç° `Copy`ã€‚
* å®ç°äº† `Drop` çš„ç±»å‹ä¸èƒ½å®ç° `Copy`ã€‚
* å¸¸è§ `Copy` ç±»å‹ï¼šæ‰€æœ‰æ•´æ•°ã€æµ®ç‚¹ã€`bool`ã€`char`ã€ä»¥åŠä»…åŒ…å« `Copy` æˆå‘˜çš„å…ƒç»„ã€‚

### 2.4 å¼•ç”¨ä¸å€Ÿç”¨

* å°† `String` ä¼ å…¥å‡½æ•°ä¼šç§»åŠ¨æ‰€æœ‰æƒï¼›è‹¥éœ€ç»§ç»­ä½¿ç”¨ï¼Œå¿…é¡»è¿”å›ä¹‹æˆ–æ”¹ç”¨å¼•ç”¨ã€‚
* ç¼–è¯‘å™¨ä¼šåœ¨æ‰€æœ‰æƒæ— æ•ˆå¤„æŠ¥é”™ï¼Œç¡®ä¿å†…å­˜å®‰å…¨ã€‚
* å¼•ç”¨ `&T` å…è®¸è®¿é—®è€Œä¸å–å¾—æ‰€æœ‰æƒï¼›ç»“æŸæ—¶ä¸ä¼šé‡Šæ”¾æŒ‡å‘çš„æ•°æ®ã€‚
* åˆ›å»ºå¼•ç”¨ç§°ä¸ºå€Ÿç”¨ã€‚
* å¯å˜å¼•ç”¨ `&mut T` å…è®¸ä¿®æ”¹å€Ÿç”¨çš„å€¼ï¼Œä½†å—ä¸¥æ ¼é™åˆ¶ã€‚

**å¼•ç”¨è§„åˆ™**
1. åŒä¸€æ—¶åˆ»ï¼Œè¦ä¹ˆæœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œè¦ä¹ˆæœ‰ä»»æ„å¤šä¸ªä¸å¯å˜å¼•ç”¨ã€‚
2. æ‰€æœ‰å¼•ç”¨å¿…é¡»æœ‰æ•ˆã€‚

### 2.5 å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼ˆsliceï¼‰

* å­—ç¬¦ä¸²åˆ‡ç‰‡ `&s[a..b]` æ˜¯å¯¹ `String` éƒ¨åˆ†å†…å®¹çš„å¼•ç”¨ï¼Œä¸æ‹¥æœ‰æ•°æ®ã€‚
* åˆ‡ç‰‡å†…éƒ¨è®°å½•èµ·å§‹ä½ç½®ä¸é•¿åº¦ï¼Œå¦‚ `&s[6..11]` èµ·å§‹ç´¢å¼•ä¸º 6ï¼Œé•¿åº¦ä¸º 5ã€‚
* åˆ‡ç‰‡é€‚ç”¨äºä»å­—ç¬¦ä¸²ä¸­å€Ÿç”¨ä¸€æ®µæ•°æ®è€Œæ— éœ€å¤åˆ¶ã€‚

## 3. ç»“æ„ä½“

ç»“æ„ä½“ï¼ˆstructï¼‰ï¼Œæˆ–è€… structureï¼Œæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œå…è®¸ä½ åŒ…è£…å’Œå‘½åå¤šä¸ªç›¸å…³çš„å€¼ï¼Œä»è€Œå½¢æˆä¸€ä¸ªæœ‰æ„ä¹‰çš„ç»„åˆã€‚å¦‚æœä½ ç†Ÿæ‚‰ä¸€é—¨é¢å‘å¯¹è±¡è¯­è¨€ï¼Œä½ ä¼šå‘ç°ä¸€ä¸ª struct å°±åƒå¯¹è±¡çš„æ•°æ®å±æ€§ã€‚

### 3.1 ç»“æ„ä½“çš„å®šä¹‰å’Œå®ä¾‹åŒ–

* ç»“æ„ä½“ç±»ä¼¼å…ƒç»„ï¼Œä½†å­—æ®µå…·åï¼Œè¯­ä¹‰æ›´æ˜ç¡®ã€‚
* ä½¿ç”¨ `struct` å®šä¹‰ï¼š

    ```rust
    struct User {
        active: bool,
        username: String,
        email: String,
        sign_in_count: u64,
    }
    ```

* å®ä¾‹åŒ–ï¼š

    ```rust
    let user1 = User {
        active: true,
        username: String::from("user"),
        email: String::from("a@b.com"),
        sign_in_count: 1,
    };
    ```

* ä½¿ç”¨ç‚¹å·è®¿é—®å’Œä¿®æ”¹å­—æ®µï¼ˆå¿…é¡»å®ä¾‹æ•´ä½“ä¸ºå¯å˜ï¼‰ï¼š

    ```rust
    user1.email = String::from("new@example.com");
    ```

* æ„é€ ç»“æ„ä½“æ—¶å­—æ®µåä¸å‚æ•°åç›¸åŒå¯ä½¿ç”¨ç®€å†™ï¼š

    ```rust
    fn build_user(email: String, username: String) -> User {
        User {
            active: true,
            username,
            email,
            sign_in_count: 1,
        }
    }
    ```

* ç”¨æ—§å®ä¾‹çš„å¤§éƒ¨åˆ†å­—æ®µæ„é€ æ–°å®ä¾‹ï¼š

    ```rust
    let user2 = User {
        email: String::from("another@example.com"),
        ..user1
    };
    ```

    æ³¨æ„ï¼šç±»ä¼¼èµ‹å€¼ï¼Œå­—æ®µä¼šè¢«ç§»åŠ¨ï¼ˆå¦‚ `String`ï¼‰ã€‚è¢«ç§»åŠ¨åçš„æ—§å®ä¾‹ç›¸åº”å­—æ®µä¸å¯å†ç”¨ã€‚

* ç»“æ„ä½“ä½†æ— å­—æ®µåï¼Œåªæœ‰ç±»å‹ï¼Œç”¨äºåˆ›å»º"æ–°ç±»å‹"ï¼š

    ```rust
    struct Color(i32, i32, i32);
    struct Point(i32, i32, i32);
    ```

    å¯ç”¨ç´¢å¼•è®¿é—®ï¼›è§£æ„éœ€å†™ç±»å‹åï¼š

    ```rust
    let Point(x, y, z) = origin;
    ```

* æ— å­—æ®µï¼Œç”¨äºå®ç° traitï¼š

    ```rust
    struct AlwaysEqual;
    let a = AlwaysEqual;
    ```

* é€šå¸¸ä½¿ç”¨æ‹¥æœ‰æ‰€æœ‰æƒçš„ç±»å‹ï¼ˆå¦‚ `String`ï¼‰æ”¾å…¥ç»“æ„ä½“ä¸­ã€‚

### 3.2 æ´¾ç”Ÿ Debug trait ä»¥ä¾¿æ‰“å°ç»“æ„ä½“

é»˜è®¤ `{}`ï¼ˆDisplayï¼‰æ— æ³•æ‰“å°ç»“æ„ä½“ã€‚å¯æ´¾ç”Ÿ Debugï¼š

```rust
#[derive(Debug)]
struct Rectangle { width: u32, height: u32 }

println!("{:?}", rect1);
println!("{:#?}", rect1); // æ›´æ˜“è¯»
```

### 3.3 dbg! å®ï¼šå¸¦æ–‡ä»¶ä½ç½®çš„è°ƒè¯•è¾“å‡º

* æ¥å—è¡¨è¾¾å¼æ‰€æœ‰æƒå¹¶è¿”å›è¡¨è¾¾å¼å€¼ã€‚
* æ‰“å°åˆ° stderrï¼š

```rust
let rect1 = Rectangle {
    width: dbg!(30 * scale), // æ‰“å°è¡¨è¾¾å¼ç»“æœ
    height: 50,
};

dbg!(&rect1); // å€Ÿç”¨é¿å…æ‰€æœ‰æƒç§»åŠ¨
```

è¾“å‡ºæ ¼å¼ç¤ºä¾‹ï¼š

```bash
[src/main.rs:10] 30 * scale = 60
[src/main.rs:14] &rect1 = Rectangle { width: 60, height: 50 }
```

### 3.4 æ–¹æ³•è¯­æ³•ï¼ˆMethodsï¼‰

* æ–¹æ³•ä¸å‡½æ•°ç±»ä¼¼ï¼Œä½†**å¿…é¡»å®šä¹‰åœ¨ impl å—å†…**ï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªå‚æ•°æ€»æ˜¯ **selfï¼ˆæˆ– &self / &mut selfï¼‰**ã€‚
* ä½œç”¨ï¼šä¸ºç»“æ„ä½“ç»„ç»‡è¡Œä¸ºï¼Œå°†â€œæ•°æ® + è¡Œä¸ºâ€ç»‘å®šåœ¨ä¸€èµ·ã€‚

* åŸºæœ¬å½¢å¼ï¼š

    ```rust
    impl Rectangle {
        fn area(&self) -> u32 {
            self.width * self.height
        }
    }
    ```

* è°ƒç”¨ï¼š

    ```rust
    rect1.area()
    ```

  * `&self` æ˜¯ `self: &Self` çš„ç®€å†™ã€‚
  * `Self` æ˜¯ impl å—ä¸­ç±»å‹çš„åˆ«åã€‚
  * æ–¹æ³•å¯ä»¥ç”¨ï¼š

    * `&self`ï¼šä¸å¯å˜å€Ÿç”¨
    * `&mut self`ï¼šå¯å˜å€Ÿç”¨
    * `self`ï¼šè·å–æ‰€æœ‰æƒï¼ˆè¾ƒå°‘ç”¨ï¼‰

* æ–¹æ³•åå¯ä¸å­—æ®µåŒå

  * å­—æ®µåè®¿é—®ï¼š`rect.width`
  * æ–¹æ³•åè®¿é—®ï¼š`rect.width()`

    Rust å¯æ ¹æ®æ˜¯å¦æœ‰æ‹¬å·è‡ªåŠ¨åŒºåˆ†å­—æ®µä¸æ–¹æ³•ã€‚

    Getter å¸¸ä»¥å­—æ®µåŒåå½¢å¼å‡ºç°ï¼›Rust ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆ getterã€‚

* æ–¹æ³•è°ƒç”¨æ—¶ï¼š

    ```rust
    p1.distance(&p2);
    ```

    ç­‰ä»·äºï¼š

    ```rust
    (&p1).distance(&p2);
    ```

    Rust è‡ªåŠ¨ä¸ºæ–¹æ³•æ¥æ”¶è€…æ·»åŠ  `&`ã€`&mut` æˆ– `*`ï¼Œä½¿å…¶åŒ¹é…æ–¹æ³•ç­¾åã€‚
    è¿™æ˜¯æ–¹æ³•è¯­æ³•å‹å¥½çš„é‡è¦åŸå› ã€‚

* å¸¦æ›´å¤šå‚æ•°çš„æ–¹æ³•

    ç¤ºä¾‹ï¼šæ¯”è¾ƒé•¿æ–¹å½¢æ˜¯å¦èƒ½åŒ…å«å¦ä¸€ä¸ªé•¿æ–¹å½¢ï¼š

    ```rust
    impl Rectangle {
        fn can_hold(&self, other: &Rectangle) -> bool {
            self.width > other.width && self.height > other.height
        }
    }
    ```

    è°ƒç”¨ï¼š

    ```rust
    rect1.can_hold(&rect2)
    ```

* å…³è”å‡½æ•°ï¼ˆAssociated Functionsï¼‰

  * å®šä¹‰åœ¨ impl å†…ï¼Œä½†æ²¡æœ‰ self å‚æ•°ï¼Œå› æ­¤**ä¸æ˜¯æ–¹æ³•**ã€‚
  * ç”¨é€”ï¼šæ„é€ å‡½æ•°ã€å·¥å…·å‡½æ•°ã€‚
  * è°ƒç”¨æ–¹å¼ï¼šç±»å‹å + `::`ã€‚

  ç¤ºä¾‹ï¼šæ„é€ æ­£æ–¹å½¢çš„é™æ€å‡½æ•°ã€‚

  ```rust
  impl Rectangle {
      fn square(size: u32) -> Self {
          Self { width: size, height: size }
      }
  }

  let sq = Rectangle::square(3);
  ```
* å¤šä¸ª impl å—åˆæ³•ä¸”å¸¸ç”¨äºï¼š

  * å°†æ–¹æ³•æŒ‰åŠŸèƒ½åˆ†åŒº
  * ä¸º trait å•ç‹¬å†™ impl
  * ä¸æ³›å‹ã€trait ç»“åˆæ—¶æŒ‰éœ€æ‹†åˆ†

  ```rust
  impl Rectangle { fn area(&self) -> u32 { ... } }
  impl Rectangle { fn can_hold(&self, other: &Rectangle) -> bool { ... } }
  ```

## 4. æšä¸¾

æšä¸¾ï¼ˆenumerationsï¼‰ï¼Œä¹Ÿè¢«ç§°ä½œ enumsã€‚æšä¸¾å…è®¸ä½ é€šè¿‡åˆ—ä¸¾å¯èƒ½çš„ å˜ä½“ï¼ˆvariantsï¼‰æ¥å®šä¹‰ä¸€ä¸ªç±»å‹ã€‚

### 4.1 æšä¸¾å®šä¹‰ä¸ç”¨é€”

ç»“æ„ä½“ç”¨äºâ€œç»„åˆå¤šä¸ªå­—æ®µâ€ã€‚
æšä¸¾ç”¨äº**åˆ—ä¸¾ä¸€ç»„å¯èƒ½çš„å€¼**ï¼Œæ¯ä¸ªå¯èƒ½æ€§ç§°ä¸º**å˜ä½“ï¼ˆvariantï¼‰**ã€‚

ç¤ºä¾‹ï¼šIPv4 ä¸ IPv6 å±äº IP åœ°å€çš„ä¸¤ç§å¯èƒ½ç±»å‹ï¼š

```rust
enum IpAddrKind {
    V4,
    V6,
}
```

- åˆ›å»ºå˜ä½“ï¼š

    ```rust
    let four = IpAddrKind::V4;
    let six = IpAddrKind::V6;
    ```

    æšä¸¾å˜ä½“ä½äºæšä¸¾çš„å‘½åç©ºé—´ï¼Œé€šè¿‡ `::` è®¿é—®ã€‚

- å°†æ•°æ®ç›´æ¥æ”¾å…¥æšä¸¾å˜ä½“ï¼š

    ```rust
    enum IpAddr {
        V4(String),
        V6(String),
    }
    ```

- ä¸åŒå˜ä½“æºå¸¦ä¸åŒç±»å‹çš„æ•°æ®

    ```rust
    enum IpAddr {
        V4(u8, u8, u8, u8),
        V6(String),
    }
    ```

- æšä¸¾èƒ½è¡¨è¾¾ç»“æ„ä½“éš¾ä»¥è¡¨è¾¾çš„å¤šæ€æ•°æ®å½¢å¼ã€‚ä¾‹å¦‚ Messageï¼š

    ```rust
    enum Message {
        Quit,
        Move { x: i32, y: i32 },
        Write(String),
        ChangeColor(i32, i32, i32),
    }
    ```

    è¿™äº›å˜ä½“å¯å¯¹åº”ä¸ºå¤šä¸ªç»“æ„ä½“ï¼Œä½†ï¼š

    * å¤šç»“æ„ä½“ â†’ å¤šç§ç±»å‹
    * ä¸€ä¸ªæšä¸¾ â†’ å•ä¸€ç±»å‹ï¼Œä¾¿äºç»Ÿä¸€å¤„ç†

- å’Œç»“æ„ä½“ä¸€æ ·ï¼Œæšä¸¾ä¹Ÿèƒ½æ‹¥æœ‰æ–¹æ³•ï¼š

    ```rust
    impl Message {
        fn call(&self) {}
    }

    let m = Message::Write(String::from("hello"));
    m.call();
    ```

- Rust ç”¨ `Option<T>` ä»£æ›¿ç©ºå€¼ï¼ˆnullï¼‰ï¼š

    ```rust
    enum Option<T> {
        None,
        Some(T),
    }
    ```

    ç‰¹ç‚¹ï¼š

    * `T` ä¸ `Option<T>` æ˜¯**ä¸¤ç§ä¸åŒç±»å‹**
    * å¿…é¡»æ˜¾å¼å¤„ç† `None`

    ç¤ºä¾‹ï¼š

    ```rust
    let some_number = Some(5);   // Option<i32>
    let absent_number: Option<i32> = None;
    ```

    ä¸èƒ½åšï¼š`x + y`ï¼ˆè‹¥ y æ˜¯ Optionï¼‰

    éœ€ä½¿ç”¨ `match` æˆ–å…¶ä»–è§£åŒ…æ–¹æ³•å–å‡ºå†…éƒ¨ Tã€‚

### 4.2 `match` æ§åˆ¶æµä¸æ¨¡å¼åŒ¹é…

- åŸºæœ¬ç”¨æ³•

    ```rust
    match coin {
        Coin::Penny => 1,
        Coin::Nickel => 5,
        ...
    }
    ```

    `match` ç‰¹ç‚¹ï¼š

    * æ‰€æœ‰æ¨¡å¼å¿…é¡»è¢«è¦†ç›–ï¼ˆç©·å°½ï¼‰
    * ç¬¬ä¸€ä¸ªåŒ¹é…çš„åˆ†æ”¯æ‰§è¡Œ
    * åˆ†æ”¯è¡¨è¾¾å¼çš„å€¼ä½œä¸º match è¿”å›å€¼

- åˆ†æ”¯ç»‘å®šï¼šä»å˜ä½“ä¸­å–æ•°æ®

    ```rust
    enum Coin {
        Quarter(UsState),
    }

    match coin {
        Coin::Quarter(state) => println!("From {state:?}"),
    }
    ```

    `state` ä¼šç»‘å®šå˜ä½“å†…éƒ¨çš„å€¼ã€‚

- ä½¿ç”¨ `match` è§£åŒ… Option<T>

    ç¤ºä¾‹ï¼šç»™ Option<i32> åŠ  1ï¼š

    ```rust
    fn plus_one(x: Option<i32>) -> Option<i32> {
        match x {
            None => None,
            Some(i) => Some(i + 1),
        }
    }
    ```

    match ç»“æ„ï¼š

    * æ¨¡å¼ `Some(i)` ç»‘å®šå†…éƒ¨å€¼
    * å¿…é¡»å¤„ç† `None`ï¼ˆå¦åˆ™ä¸é€šè¿‡ç¼–è¯‘ï¼‰

- `match` è¦æ±‚ç©·å°½æ€§æ£€æŸ¥ï¼Œæ¼æ‰æŸä¸ªå˜ä½“ä¼šæŠ¥é”™ï¼š

    ```rust
    match x {
        Some(i) => Some(i + 1),
        // ERROR: None æœªè¦†ç›–
    }
    ```

    Rust å¼ºåˆ¶ä½ æ˜¾å¼è€ƒè™‘æ‰€æœ‰æƒ…å†µï¼Œé¿å…â€œå¿˜è®°å¤„ç†ç©ºå€¼â€è¿™ç§è¿è¡Œæ—¶é”™è¯¯ã€‚

- é€šé…æ¨¡å¼ä¸ `_` å ä½ç¬¦

  - é€šé…æ¨¡å¼ç”¨äºåŒ¹é…æ‰€æœ‰æœªåˆ—å‡ºçš„æƒ…å†µï¼š

    ```rust
    match dice_roll {
        3 => add_hat(),
        7 => remove_hat(),
        other => move_player(other),
    }
    ```

  - è‹¥ä¸éœ€è¦å€¼ï¼Œç”¨ `_`ï¼š

    ```rust
    match dice_roll {
        3 => add_hat(),
        7 => remove_hat(),
        _ => reroll(),
    }
    ```

  - ç”šè‡³ä¸æ‰§è¡Œä»»ä½•é€»è¾‘ï¼š

    ```rust
    match dice_roll {
        3 => add_hat(),
        7 => remove_hat(),
        _ => (),
    }
    ```

### 4.3 æšä¸¾æ§åˆ¶æµæ¢³ç†

#### `match`ï¼šå…¨é¢åŒ¹é…ï¼Œå¼ºåˆ¶ç©·å°½æ‰€æœ‰å¯èƒ½æ€§

- ç‰¹ç‚¹ï¼š

  * æ¨¡å¼å¿…é¡»ç©·å°½æ‰€æœ‰åˆ†æ”¯
  * èƒ½ç»‘å®šå˜ä½“å†…çš„å€¼
  * é€‚åˆâ€œæ¯ç§æƒ…å†µéƒ½æœ‰é€»è¾‘â€çš„åœºæ™¯

- æ¨¡æ¿ï¼š

    ```rust
    match value {
        Pattern1 => expr1,
        Pattern2 => expr2,
        _ => default,
    }
    ```

#### `if let`ï¼šåªå…³å¿ƒä¸€ç§æƒ…å†µï¼Œå…¶ä½™å¿½ç•¥

- ç‰¹ç‚¹ï¼š

    * åªåŒ¹é…ä¸€ç§æ¨¡å¼
    * ä¸éœ€è¦ç©·å°½æ€§
    * ç”¨äºâ€œåªåœ¨æˆåŠŸæƒ…å†µä¸‹æ‰§è¡Œâ€

- æ¨¡æ¿ï¼š

    ```rust
    if let Pattern(x) = value {
        // x åªåœ¨è¿™é‡Œå­˜åœ¨
    }
    ```

- ç­‰ä»·äºï¼š

    ```rust
    match value {
        Pattern(x) => { ... }
        _ => {}
    }
    ```

#### `if let â€¦ else`ï¼šä¸€ç§æƒ…å†µåŒ¹é…ï¼Œå…¶ä½™æƒ…å†µç»Ÿä¸€å¤„ç†

ç”¨äºâ€œä¸¤åˆ†æ”¯é€»è¾‘ï¼Œä½†åªæœ‰ä¸€ä¸ªåˆ†æ”¯å…³å¿ƒå€¼ç»‘å®šâ€çš„æƒ…å†µï¼š

```rust
if let Pattern(x) = value {
    // æˆåŠŸ
} else {
    // å¤±è´¥é€»è¾‘
}
```

ç­‰ä»·äºä¸¤åˆ†æ”¯ `match`ã€‚

#### `let â€¦ else`ï¼šè¦ä¹ˆç»‘å®šæˆåŠŸï¼Œè¦ä¹ˆç«‹å³é€€å‡ºå½“å‰å‡½æ•°ï¼ˆé‡ç‚¹ï¼‰

- ç‰¹ç‚¹ï¼š

    * æ¨¡å¼åŒ¹é…æˆåŠŸåï¼Œç»‘å®šçš„å˜é‡å¯åœ¨ **åç»­æ•´ä¸ªå‡½æ•°ä¸­ä½¿ç”¨**
    * åŒ¹é…å¤±è´¥æ—¶ï¼Œelse å¿…é¡»æ‰§è¡Œ **return / break / continue / panic!**
    * éå¸¸é€‚åˆâ€œå¤±è´¥æ—¶ä¸ç»§ç»­æ‰§è¡Œâ€çš„é€»è¾‘ï¼ˆæ‰€è°“ happy pathï¼‰

- æ¨¡æ¿ï¼š

    ```rust
    let Pattern(x) = value else {
        return ...;
    };

    println!("{x}"); // x åœ¨è¿™é‡Œå¿…å®šå­˜åœ¨
    ```

    è¿™æ˜¯è®©æ§åˆ¶æµâ€œæå‰æ’é™¤å¤±è´¥è·¯å¾„â€çš„è¯­æ³•å·¥å…·ã€‚

#### å®Œæ•´å¯ç¼–è¯‘è¿è¡Œç¤ºä¾‹

```rust
#[derive(Debug)]
enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter(State),
}

#[derive(Debug)]
enum State {
    Alabama,
    Alaska,
}

impl State {
    fn existed_in(&self, year: u32) -> bool {
        match self {
            State::Alabama => year <= 1900,
            State::Alaska => year <= 1959,
        }
    }
}

// ä½¿ç”¨ matchï¼šå¤šåˆ†æ”¯ï¼Œç©·å°½æ‰€æœ‰æƒ…å†µ
fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => 1,
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter(_) => 25,
    }
}

// ä½¿ç”¨ if letï¼šåªå…³å¿ƒ Quarter
fn print_if_quarter(coin: &Coin) {
    if let Coin::Quarter(state) = coin {
        println!("if let: quarter from {:?}", state);
    }
}

// if let â€¦ elseï¼šä¸¤åˆ†æ”¯é€»è¾‘
fn describe_quarter_if_else(coin: &Coin) {
    if let Coin::Quarter(state) = coin {
        println!("if let else: quarter from {:?}", state);
    } else {
        println!("if let else: not a quarter");
    }
}

// let â€¦ elseï¼šç»‘å®šå¤±è´¥ç«‹å³é€€å‡ºï¼ˆé‡å¤´æˆï¼‰
fn describe_state_quarter(coin: Coin) -> Option<String> {
    // è¦ä¹ˆæˆåŠŸç»‘å®š stateï¼Œè¦ä¹ˆè¿”å› None
    let Coin::Quarter(state) = coin else {
        return None;
    };

    // èµ°åˆ°è¿™é‡Œè¯´æ˜ä¸€å®šæ˜¯ Quarterï¼Œå¹¶ä¸” state å·²ç»‘å®š
    let msg = if state.existed_in(1900) {
        format!("{state:?} is pretty old!")
    } else {
        format!("{state:?} is relatively new.")
    };

    Some(msg)
}

fn main() {
    let c1 = Coin::Quarter(State::Alaska);
    let c2 = Coin::Dime;

    println!("value_in_cents(c1) = {}", value_in_cents(c1.clone()));

    print_if_quarter(&c1);
    print_if_quarter(&c2);

    describe_quarter_if_else(&c1);
    describe_quarter_if_else(&c2);

    println!("describe_state_quarter(c1) = {:?}", describe_state_quarter(c1));
    println!("describe_state_quarter(c2) = {:?}", describe_state_quarter(c2));
}
```
ç¤ºä¾‹è¾“å‡º

```bash
value_in_cents(c1) = 25
if let: quarter from Alaska
describe_quarter_if_else: quarter from Alaska
describe_quarter_if_else: not a quarter
describe_state_quarter(c1) = Some("Alaska is relatively new.")
describe_state_quarter(c2) = None
```

#### æšä¸¾æ§åˆ¶æµæ€»ç»“

| è¯­æ³•            | ç”¨é€”             | æ˜¯å¦ç»‘å®šå˜é‡     | æ˜¯å¦å¿…é¡»ç©·å°½  | å¤±è´¥æ—¶è¡Œä¸º    |
| ------------- | -------------- | ---------- | ------- | -------- |
| match         | å¤šåˆ†æ”¯åˆ¤æ–­ï¼ˆå…¨å±€é€»è¾‘ï¼‰    | æ˜¯          | æ˜¯       | æ—         |
| if let        | å•åˆ†æ”¯æˆåŠŸé€»è¾‘        | æ˜¯ï¼ˆä»…æˆåŠŸï¼‰     | å¦       | ä»€ä¹ˆä¸åš     |
| if let â€¦ else | æˆåŠŸé€»è¾‘ + å…œåº•é€»è¾‘    | æ˜¯ï¼ˆä»…æˆåŠŸï¼‰     | å¦       | æ‰§è¡Œ else  |
| let â€¦ else    | æˆåŠŸåç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™é€€å‡ºå‡½æ•° | æ˜¯ï¼ˆæˆåŠŸåå…¨å±€å¯ç”¨ï¼‰ | å¿…é¡»ï¼ˆä»…ä¸€ç§ï¼‰ | return ç­‰ |







